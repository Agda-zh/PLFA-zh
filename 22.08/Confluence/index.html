<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="../assets/css/light.css" integrity="sha512-MkpYfmkWIfATGEd6NpDhZJQB2nIkJDL4/+fTWrR8KGUYK4WpHdNkNtsOewHrkVqI4K1SrtjK7aC/fwQljbifBA==" title="Light" id="stylesheet-light"><link rel="alternate stylesheet" href="../assets/css/dark.css" integrity="sha512-T2Tad3PSo5pIHyLVaV57XanuJRwSgTPT+WVb96FUf6y0ZJIXP4d/lNPJUqbUZ3j0Nq/gej2yteryEz/Hkr2Cdg==" title="Dark" id="stylesheet-dark" disabled><title>Programming Language Foundations in Agda – Confluence</title><script src="../assets/js/anchor.js" integrity="sha512-Y5IMGqYQp36NYYdEL6gXISLsHNpx0LxW0NS0twvYBvXI8GH5PZa1g5gm1B5lxg6tlFyUAiOOfgKL/NIn0dtY4w==" id="script-anchor"></script><script src="../assets/js/darkmode.js" integrity="sha512-iUX9HnSphH4WbMv88MYJEFtLfkCtTHrvWyFwjigSm5GkwHv1L31GP5grIGDo7kI2jftuYVvt4xu4qeCn2fKbww==" id="script-darkmode"></script><script src="../assets/js/main.js" integrity="sha512-X7aZg6IUKq1TvTVjSureaMGKZ/ylbAD7kxiU2w42IUgh4lUTWoOsoIWzNvrqkwBJdQ1y2GsS67gtsv39Uuq6ew==" id="script-main"></script></head><body><header class="site-header"><div class="wrapper"><a class="site-title" href="../">Programming Language Foundations in Agda</a><nav class="site-nav"><input type="checkbox" id="nav-trigger" class="nav-trigger"><label for="nav-trigger"><span class="menu-icon"><svg class="svg-icon grey" viewBox="0 0 18 15" width="18px" height="15px"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path></svg></span></label><div class="trigger"><a class="page-link" href="../">The Book</a> <a class="page-link" href="../Announcements/">Announcements</a> <a class="page-link" href="../GettingStarted/">Getting Started</a> <a class="page-link" href="../Citing/">Citing</a> <a class="page-link" href="https://agda-zh.github.io/PLFA-zh/">中文</a> <a class="page-link" onclick="window.darkmode.toggle()"><i id="darkmode-trigger" class="fas fa-moon"></i></a></div></nav></div></header><main class="page-content" aria-label="Content"><div class="wrapper"><article class="post"><nav class="pager"><ul class="pagination"><li><a class="pagelink" href="../Untyped/">Prev</a></li><li class="separator">•</li><li><a class="pagelink" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/part2/Confluence.lagda.md">Source</a></li><li class="separator">•</li><li><a class="pagelink" href="../BigStep/">Next</a></li><li class="separator">•</li></ul></nav><header class="post-header"><h1 class="post-title">Confluence: Confluence of untyped lambda calculus</h1></header><div class="post-content"><pre class="Agda"><a id="plfa_plfa-part2-Confluence-107" class="Keyword">module</a> <a id="plfa_plfa-part2-Confluence-114" href="../Confluence/#" class="Module">plfa.part2.Confluence</a> <a id="plfa_plfa-part2-Confluence-136" class="Keyword">where</a>
</pre><h2 id="introduction">Introduction</h2><p>In this chapter we prove that beta reduction is <em>confluent</em>, a property also known as <em>Church-Rosser</em>. That is, if there are reduction sequences from any term <code>L</code> to two different terms <code>M₁</code> and <code>M₂</code>, then there exist reduction sequences from those two terms to some common term <code>N</code>. In pictures:</p><pre><code>    L
   / \
  /   \
 /     \
M₁      M₂
 \     /
  \   /
   \ /
    N</code></pre><p>where downward lines are instances of <code>—↠</code>.</p><p>Confluence is studied in many other kinds of rewrite systems besides the lambda calculus, and it is well known how to prove confluence in rewrite systems that enjoy the <em>diamond property</em>, a single-step version of confluence. Let <code>⇛</code> be a relation. Then <code>⇛</code> has the diamond property if whenever <code>L ⇛ M₁</code> and <code>L ⇛ M₂</code>, then there exists an <code>N</code> such that <code>M₁ ⇛ N</code> and <code>M₂ ⇛ N</code>. This is just an instance of the same picture above, where downward lines are now instance of <code>⇛</code>. If we write <code>⇛*</code> for the reflexive and transitive closure of <code>⇛</code>, then confluence of <code>⇛*</code> follows immediately from the diamond property.</p><p>Unfortunately, reduction in the lambda calculus does not satisfy the diamond property. Here is a counter example.</p><pre><code>(λ x. x x)((λ x. x) a) —→ (λ x. x x) a
(λ x. x x)((λ x. x) a) —→ ((λ x. x) a) ((λ x. x) a)</code></pre><p>Both terms can reduce to <code>a a</code>, but the second term requires two steps to get there, not one.</p><p>To side-step this problem, we’ll define an auxiliary reduction relation, called <em>parallel reduction</em>, that can perform many reductions simultaneously and thereby satisfy the diamond property. Furthermore, we show that a parallel reduction sequence exists between any two terms if and only if a beta reduction sequence exists between them. Thus, we can reduce the proof of confluence for beta reduction to confluence for parallel reduction.</p><h2 id="imports">Imports</h2><pre class="Agda"><a id="plfa_plfa-part2-Confluence-2000" class="Keyword">open</a> <a id="plfa_plfa-part2-Confluence-2005" class="Keyword">import</a> <a id="plfa_plfa-part2-Confluence-2012" href="https://agda.github.io/agda-stdlib/v1.7.1/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="plfa_plfa-part2-Confluence-2050" class="Keyword">using</a> <a id="plfa_plfa-part2-Confluence-2056" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-2057" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="plfa_plfa-part2-Confluence-2060" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2062" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="plfa_plfa-part2-Confluence-2066" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-2068" class="Keyword">open</a> <a id="plfa_plfa-part2-Confluence-2073" class="Keyword">import</a> <a id="plfa_plfa-part2-Confluence-2080" href="https://agda.github.io/agda-stdlib/v1.7.1/Function.html" class="Module">Function</a> <a id="plfa_plfa-part2-Confluence-2089" class="Keyword">using</a> <a id="plfa_plfa-part2-Confluence-2095" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-2096" href="https://agda.github.io/agda-stdlib/v1.7.1/Function.Base.html#1031" class="Function Operator">_∘_</a><a id="plfa_plfa-part2-Confluence-2099" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-2101" class="Keyword">open</a> <a id="plfa_plfa-part2-Confluence-2106" class="Keyword">import</a> <a id="plfa_plfa-part2-Confluence-2113" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html" class="Module">Data.Product</a> <a id="plfa_plfa-part2-Confluence-2126" class="Keyword">using</a> <a id="plfa_plfa-part2-Confluence-2132" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-2133" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1167" class="Function Operator">_×_</a><a id="plfa_plfa-part2-Confluence-2136" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2138" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Sigma.html#166" class="Record">Σ</a><a id="plfa_plfa-part2-Confluence-2139" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2141" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">Σ-syntax</a><a id="plfa_plfa-part2-Confluence-2149" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2151" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1369" class="Function">∃</a><a id="plfa_plfa-part2-Confluence-2152" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2154" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1806" class="Function">∃-syntax</a><a id="plfa_plfa-part2-Confluence-2162" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2164" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="plfa_plfa-part2-Confluence-2169" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2171" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="plfa_plfa-part2-Confluence-2176" class="Symbol">)</a>
  <a id="plfa_plfa-part2-Confluence-2180" class="Keyword">renaming</a> <a id="plfa_plfa-part2-Confluence-2189" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-2190" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="plfa_plfa-part2-Confluence-2194" class="Symbol">to</a> <a id="plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨_,_⟩</a><a id="plfa_plfa-part2-Confluence-2202" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-2204" class="Keyword">open</a> <a id="plfa_plfa-part2-Confluence-2209" class="Keyword">import</a> <a id="plfa_plfa-part2-Confluence-2216" href="../Substitution/#" class="Module">plfa.part2.Substitution</a> <a id="plfa_plfa-part2-Confluence-2240" class="Keyword">using</a> <a id="plfa_plfa-part2-Confluence-2246" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-2247" href="../Substitution/#plfa_plfa-part2-Substitution-2124" class="Function">Rename</a><a id="plfa_plfa-part2-Confluence-2253" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2255" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a><a id="plfa_plfa-part2-Confluence-2260" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-2262" class="Keyword">open</a> <a id="plfa_plfa-part2-Confluence-2267" class="Keyword">import</a> <a id="plfa_plfa-part2-Confluence-2274" href="../Untyped/#" class="Module">plfa.part2.Untyped</a>
  <a id="plfa_plfa-part2-Confluence-2295" class="Keyword">using</a> <a id="plfa_plfa-part2-Confluence-2301" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-2302" href="../Untyped/#plfa_plfa-part2-Untyped-9956" class="Datatype Operator">_—→_</a><a id="plfa_plfa-part2-Confluence-2306" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2308" href="../Untyped/#plfa_plfa-part2-Untyped-10186" class="InductiveConstructor">β</a><a id="plfa_plfa-part2-Confluence-2309" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2311" href="../Untyped/#plfa_plfa-part2-Untyped-10006" class="InductiveConstructor">ξ₁</a><a id="plfa_plfa-part2-Confluence-2313" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2315" href="../Untyped/#plfa_plfa-part2-Untyped-10096" class="InductiveConstructor">ξ₂</a><a id="plfa_plfa-part2-Confluence-2317" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2319" href="../Untyped/#plfa_plfa-part2-Untyped-10294" class="InductiveConstructor">ζ</a><a id="plfa_plfa-part2-Confluence-2320" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2322" href="../Untyped/#plfa_plfa-part2-Untyped-11088" class="Datatype Operator">_—↠_</a><a id="plfa_plfa-part2-Confluence-2326" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2328" href="../Untyped/#plfa_plfa-part2-Untyped-11294" class="Function Operator">begin_</a><a id="plfa_plfa-part2-Confluence-2334" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2336" href="../Untyped/#plfa_plfa-part2-Untyped-11194" class="InductiveConstructor Operator">_—→⟨_⟩_</a><a id="plfa_plfa-part2-Confluence-2343" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2345" href="../Untyped/#plfa_plfa-part2-Untyped-22087" class="Function Operator">_—↠⟨_⟩_</a><a id="plfa_plfa-part2-Confluence-2352" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2354" href="../Untyped/#plfa_plfa-part2-Untyped-11138" class="InductiveConstructor Operator">_∎</a><a id="plfa_plfa-part2-Confluence-2356" class="Symbol">;</a>
  <a id="plfa_plfa-part2-Confluence-2360" href="../Untyped/#plfa_plfa-part2-Untyped-23992" class="Function">abs-cong</a><a id="plfa_plfa-part2-Confluence-2368" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2370" href="../Untyped/#plfa_plfa-part2-Untyped-22987" class="Function">appL-cong</a><a id="plfa_plfa-part2-Confluence-2379" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2381" href="../Untyped/#plfa_plfa-part2-Untyped-23760" class="Function">appR-cong</a><a id="plfa_plfa-part2-Confluence-2390" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2392" href="../Untyped/#plfa_plfa-part2-Untyped-21813" class="Function">—↠-trans</a><a id="plfa_plfa-part2-Confluence-2400" class="Symbol">;</a>
  <a id="plfa_plfa-part2-Confluence-2404" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">_⊢_</a><a id="plfa_plfa-part2-Confluence-2407" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2409" href="../Untyped/#plfa_plfa-part2-Untyped-3469" class="Datatype Operator">_∋_</a><a id="plfa_plfa-part2-Confluence-2412" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2414" href="../Untyped/#plfa_plfa-part2-Untyped-4282" class="InductiveConstructor Operator">`_</a><a id="plfa_plfa-part2-Confluence-2416" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2418" href="../Untyped/#plfa_plfa-part2-Untyped-5071" class="Function Operator">#_</a><a id="plfa_plfa-part2-Confluence-2420" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2422" href="../Untyped/#plfa_plfa-part2-Untyped-3131" class="InductiveConstructor Operator">_,_</a><a id="plfa_plfa-part2-Confluence-2425" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2427" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-2428" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2430" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ_</a><a id="plfa_plfa-part2-Confluence-2432" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2434" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">_·_</a><a id="plfa_plfa-part2-Confluence-2437" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2439" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">_[_]</a><a id="plfa_plfa-part2-Confluence-2443" class="Symbol">;</a>
  <a id="plfa_plfa-part2-Confluence-2447" href="../Untyped/#plfa_plfa-part2-Untyped-6207" class="Function">rename</a><a id="plfa_plfa-part2-Confluence-2453" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2455" href="../Untyped/#plfa_plfa-part2-Untyped-5893" class="Function">ext</a><a id="plfa_plfa-part2-Confluence-2458" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2460" href="../Untyped/#plfa_plfa-part2-Untyped-6647" class="Function">exts</a><a id="plfa_plfa-part2-Confluence-2464" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2466" href="../Untyped/#plfa_plfa-part2-Untyped-3505" class="InductiveConstructor">Z</a><a id="plfa_plfa-part2-Confluence-2467" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2469" href="../Untyped/#plfa_plfa-part2-Untyped-3550" class="InductiveConstructor Operator">S_</a><a id="plfa_plfa-part2-Confluence-2471" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2473" href="../Untyped/#plfa_plfa-part2-Untyped-6943" class="Function">subst</a><a id="plfa_plfa-part2-Confluence-2478" class="Symbol">;</a> <a id="plfa_plfa-part2-Confluence-2480" href="../Untyped/#plfa_plfa-part2-Untyped-7359" class="Function">subst-zero</a><a id="plfa_plfa-part2-Confluence-2490" class="Symbol">)</a>
</pre><h2 id="parallel-reduction">Parallel Reduction</h2><p>The parallel reduction relation is defined as follows.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-2584" class="Keyword">infix</a> <a id="plfa_plfa-part2-Confluence-2590" class="Number">2</a> <a id="plfa_plfa-part2-Confluence-2592" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">_⇛_</a>

<a id="plfa_plfa-part2-Confluence-2597" class="Keyword">data</a> <a id="plfa_plfa-part2-Confluence-_⇛_"></a><a id="plfa_plfa-part2-Confluence-2602" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">_⇛_</a> <a id="plfa_plfa-part2-Confluence-2606" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-2608" class="Symbol">∀</a> <a id="plfa_plfa-part2-Confluence-2610" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-2611" href="../Confluence/#plfa_plfa-part2-Confluence-2611" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-2613" href="../Confluence/#plfa_plfa-part2-Confluence-2613" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-2614" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-2616" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2618" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-2619" href="../Confluence/#plfa_plfa-part2-Confluence-2611" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-2621" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-2623" href="../Confluence/#plfa_plfa-part2-Confluence-2613" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-2624" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-2626" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2628" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-2629" href="../Confluence/#plfa_plfa-part2-Confluence-2611" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-2631" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-2633" href="../Confluence/#plfa_plfa-part2-Confluence-2613" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-2634" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-2636" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2638" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Primitive.html#326" class="Primitive">Set</a> <a id="plfa_plfa-part2-Confluence-2642" class="Keyword">where</a>

  <a id="plfa_plfa-part2-Confluence-_⇛_.pvar"></a><a id="plfa_plfa-part2-Confluence-2651" href="../Confluence/#plfa_plfa-part2-Confluence-2651" class="InductiveConstructor">pvar</a> <a id="plfa_plfa-part2-Confluence-2656" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-2658" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-2660" href="../Confluence/#plfa_plfa-part2-Confluence-2660" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-2662" href="../Confluence/#plfa_plfa-part2-Confluence-2662" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-2663" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-2665" href="../Confluence/#plfa_plfa-part2-Confluence-2665" class="Bound">x</a> <a id="plfa_plfa-part2-Confluence-2667" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-2669" href="../Confluence/#plfa_plfa-part2-Confluence-2660" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-2671" href="../Untyped/#plfa_plfa-part2-Untyped-3469" class="Datatype Operator">∋</a> <a id="plfa_plfa-part2-Confluence-2673" href="../Confluence/#plfa_plfa-part2-Confluence-2662" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-2674" class="Symbol">}</a>
      <a id="plfa_plfa-part2-Confluence-2682" class="Comment">---------</a>
    <a id="plfa_plfa-part2-Confluence-2696" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2698" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-2699" href="../Untyped/#plfa_plfa-part2-Untyped-4282" class="InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-Confluence-2701" href="../Confluence/#plfa_plfa-part2-Confluence-2665" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-2702" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-2704" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-2706" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-2707" href="../Untyped/#plfa_plfa-part2-Untyped-4282" class="InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-Confluence-2709" href="../Confluence/#plfa_plfa-part2-Confluence-2665" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-2710" class="Symbol">)</a>

  <a id="plfa_plfa-part2-Confluence-_⇛_.pabs"></a><a id="plfa_plfa-part2-Confluence-2715" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-2720" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-2722" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-2724" href="../Confluence/#plfa_plfa-part2-Confluence-2724" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-2725" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-2727" href="../Confluence/#plfa_plfa-part2-Confluence-2727" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-2729" href="../Confluence/#plfa_plfa-part2-Confluence-2729" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-2732" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-2734" href="../Confluence/#plfa_plfa-part2-Confluence-2724" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-2736" href="../Untyped/#plfa_plfa-part2-Untyped-3131" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-2738" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-Confluence-2740" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-2742" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-2743" class="Symbol">}</a>
    <a id="plfa_plfa-part2-Confluence-2749" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2751" href="../Confluence/#plfa_plfa-part2-Confluence-2727" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-2753" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-2755" href="../Confluence/#plfa_plfa-part2-Confluence-2729" class="Bound">N′</a>
      <a id="plfa_plfa-part2-Confluence-2764" class="Comment">----------</a>
    <a id="plfa_plfa-part2-Confluence-2779" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2781" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-2783" href="../Confluence/#plfa_plfa-part2-Confluence-2727" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-2785" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-2787" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-2789" href="../Confluence/#plfa_plfa-part2-Confluence-2729" class="Bound">N′</a>

  <a id="plfa_plfa-part2-Confluence-_⇛_.papp"></a><a id="plfa_plfa-part2-Confluence-2795" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-2800" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-2802" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-2804" href="../Confluence/#plfa_plfa-part2-Confluence-2804" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-2805" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-2807" href="../Confluence/#plfa_plfa-part2-Confluence-2807" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-2809" href="../Confluence/#plfa_plfa-part2-Confluence-2809" class="Bound">L′</a> <a id="plfa_plfa-part2-Confluence-2812" href="../Confluence/#plfa_plfa-part2-Confluence-2812" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-2814" href="../Confluence/#plfa_plfa-part2-Confluence-2814" class="Bound">M′</a> <a id="plfa_plfa-part2-Confluence-2817" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-2819" href="../Confluence/#plfa_plfa-part2-Confluence-2804" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-2821" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-2823" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-2824" class="Symbol">}</a>
    <a id="plfa_plfa-part2-Confluence-2830" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2832" href="../Confluence/#plfa_plfa-part2-Confluence-2807" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-2834" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-2836" href="../Confluence/#plfa_plfa-part2-Confluence-2809" class="Bound">L′</a>
    <a id="plfa_plfa-part2-Confluence-2843" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2845" href="../Confluence/#plfa_plfa-part2-Confluence-2812" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-2847" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-2849" href="../Confluence/#plfa_plfa-part2-Confluence-2814" class="Bound">M′</a>
      <a id="plfa_plfa-part2-Confluence-2858" class="Comment">-----------------</a>
    <a id="plfa_plfa-part2-Confluence-2880" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2882" href="../Confluence/#plfa_plfa-part2-Confluence-2807" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-2884" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-2886" href="../Confluence/#plfa_plfa-part2-Confluence-2812" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-2888" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-2890" href="../Confluence/#plfa_plfa-part2-Confluence-2809" class="Bound">L′</a> <a id="plfa_plfa-part2-Confluence-2893" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-2895" href="../Confluence/#plfa_plfa-part2-Confluence-2814" class="Bound">M′</a>

  <a id="plfa_plfa-part2-Confluence-_⇛_.pbeta"></a><a id="plfa_plfa-part2-Confluence-2901" href="../Confluence/#plfa_plfa-part2-Confluence-2901" class="InductiveConstructor">pbeta</a> <a id="plfa_plfa-part2-Confluence-2907" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-2909" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-2911" href="../Confluence/#plfa_plfa-part2-Confluence-2911" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-2912" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-2914" href="../Confluence/#plfa_plfa-part2-Confluence-2914" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-2916" href="../Confluence/#plfa_plfa-part2-Confluence-2916" class="Bound">N′</a>  <a id="plfa_plfa-part2-Confluence-2920" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-2922" href="../Confluence/#plfa_plfa-part2-Confluence-2911" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-2924" href="../Untyped/#plfa_plfa-part2-Untyped-3131" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-2926" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-Confluence-2928" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-2930" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-2931" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-2933" href="../Confluence/#plfa_plfa-part2-Confluence-2933" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-2935" href="../Confluence/#plfa_plfa-part2-Confluence-2935" class="Bound">M′</a> <a id="plfa_plfa-part2-Confluence-2938" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-2940" href="../Confluence/#plfa_plfa-part2-Confluence-2911" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-2942" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-2944" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-2945" class="Symbol">}</a>
    <a id="plfa_plfa-part2-Confluence-2951" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2953" href="../Confluence/#plfa_plfa-part2-Confluence-2914" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-2955" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-2957" href="../Confluence/#plfa_plfa-part2-Confluence-2916" class="Bound">N′</a>
    <a id="plfa_plfa-part2-Confluence-2964" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-2966" href="../Confluence/#plfa_plfa-part2-Confluence-2933" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-2968" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-2970" href="../Confluence/#plfa_plfa-part2-Confluence-2935" class="Bound">M′</a>
      <a id="plfa_plfa-part2-Confluence-2979" class="Comment">-----------------------</a>
    <a id="plfa_plfa-part2-Confluence-3007" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-3009" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-3010" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-3012" href="../Confluence/#plfa_plfa-part2-Confluence-2914" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-3013" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-3015" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-3017" href="../Confluence/#plfa_plfa-part2-Confluence-2933" class="Bound">M</a>  <a id="plfa_plfa-part2-Confluence-3020" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a>  <a id="plfa_plfa-part2-Confluence-3023" href="../Confluence/#plfa_plfa-part2-Confluence-2916" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-3026" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">[</a> <a id="plfa_plfa-part2-Confluence-3028" href="../Confluence/#plfa_plfa-part2-Confluence-2935" class="Bound">M′</a> <a id="plfa_plfa-part2-Confluence-3031" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">]</a>
</pre><p>The first three rules are congruences that reduce each of their parts simultaneously. The last rule reduces a lambda term and term in parallel followed by a beta step.</p><p>We remark that the <code>pabs</code>, <code>papp</code>, and <code>pbeta</code> rules perform reduction on all their subexpressions simultaneously. Also, the <code>pabs</code> rule is akin to the <code>ζ</code> rule and <code>pbeta</code> is akin to <code>β</code>.</p><p>Parallel reduction is reflexive.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-par-refl"></a><a id="plfa_plfa-part2-Confluence-3438" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a> <a id="plfa_plfa-part2-Confluence-3447" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-3449" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-3451" href="../Confluence/#plfa_plfa-part2-Confluence-3451" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-3453" href="../Confluence/#plfa_plfa-part2-Confluence-3453" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3454" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-3456" href="../Confluence/#plfa_plfa-part2-Confluence-3456" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-3458" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-3460" href="../Confluence/#plfa_plfa-part2-Confluence-3451" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-3462" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-3464" href="../Confluence/#plfa_plfa-part2-Confluence-3453" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3465" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3467" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-3469" href="../Confluence/#plfa_plfa-part2-Confluence-3456" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-3471" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-3473" href="../Confluence/#plfa_plfa-part2-Confluence-3456" class="Bound">M</a>
<a id="plfa_plfa-part2-Confluence-3475" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a> <a id="plfa_plfa-part2-Confluence-3484" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3485" href="../Confluence/#plfa_plfa-part2-Confluence-3485" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-3486" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3488" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3489" href="../Confluence/#plfa_plfa-part2-Confluence-3489" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3490" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3492" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3493" href="../Untyped/#plfa_plfa-part2-Untyped-4282" class="InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-Confluence-3495" href="../Confluence/#plfa_plfa-part2-Confluence-3495" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-3496" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3498" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-3500" href="../Confluence/#plfa_plfa-part2-Confluence-2651" class="InductiveConstructor">pvar</a>
<a id="plfa_plfa-part2-Confluence-3505" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a> <a id="plfa_plfa-part2-Confluence-3514" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3515" href="../Confluence/#plfa_plfa-part2-Confluence-3515" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-3516" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3518" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3519" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-3520" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3522" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3523" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-3525" href="../Confluence/#plfa_plfa-part2-Confluence-3525" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-3526" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3528" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-3530" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-3535" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a>
<a id="plfa_plfa-part2-Confluence-3544" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a> <a id="plfa_plfa-part2-Confluence-3553" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3554" href="../Confluence/#plfa_plfa-part2-Confluence-3554" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-3555" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3557" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3558" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-3559" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3561" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3562" href="../Confluence/#plfa_plfa-part2-Confluence-3562" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-3564" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-3566" href="../Confluence/#plfa_plfa-part2-Confluence-3566" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-3567" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3569" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-3571" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-3576" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a> <a id="plfa_plfa-part2-Confluence-3585" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a>
</pre><p>We define the sequences of parallel reduction as follows.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-3665" class="Keyword">infix</a>  <a id="plfa_plfa-part2-Confluence-3672" class="Number">2</a> <a id="plfa_plfa-part2-Confluence-3674" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">_⇛*_</a>
<a id="plfa_plfa-part2-Confluence-3679" class="Keyword">infixr</a> <a id="plfa_plfa-part2-Confluence-3686" class="Number">2</a> <a id="plfa_plfa-part2-Confluence-3688" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">_⇛⟨_⟩_</a>
<a id="plfa_plfa-part2-Confluence-3695" class="Keyword">infix</a>  <a id="plfa_plfa-part2-Confluence-3702" class="Number">3</a> <a id="plfa_plfa-part2-Confluence-3704" href="../Confluence/#plfa_plfa-part2-Confluence-3763" class="InductiveConstructor Operator">_∎</a>

<a id="plfa_plfa-part2-Confluence-3708" class="Keyword">data</a> <a id="plfa_plfa-part2-Confluence-_⇛*_"></a><a id="plfa_plfa-part2-Confluence-3713" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">_⇛*_</a> <a id="plfa_plfa-part2-Confluence-3718" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-3720" class="Symbol">∀</a> <a id="plfa_plfa-part2-Confluence-3722" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3723" href="../Confluence/#plfa_plfa-part2-Confluence-3723" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-3725" href="../Confluence/#plfa_plfa-part2-Confluence-3725" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3726" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3728" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-3730" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-3731" href="../Confluence/#plfa_plfa-part2-Confluence-3723" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-3733" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-3735" href="../Confluence/#plfa_plfa-part2-Confluence-3725" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3736" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-3738" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-3740" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-3741" href="../Confluence/#plfa_plfa-part2-Confluence-3723" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-3743" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-3745" href="../Confluence/#plfa_plfa-part2-Confluence-3725" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3746" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-3748" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-3750" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Primitive.html#326" class="Primitive">Set</a> <a id="plfa_plfa-part2-Confluence-3754" class="Keyword">where</a>

  <a id="plfa_plfa-part2-Confluence-_⇛*_._∎"></a><a id="plfa_plfa-part2-Confluence-3763" href="../Confluence/#plfa_plfa-part2-Confluence-3763" class="InductiveConstructor Operator">_∎</a> <a id="plfa_plfa-part2-Confluence-3766" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-3768" class="Symbol">∀</a> <a id="plfa_plfa-part2-Confluence-3770" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3771" href="../Confluence/#plfa_plfa-part2-Confluence-3771" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-3773" href="../Confluence/#plfa_plfa-part2-Confluence-3773" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3774" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3776" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-3777" href="../Confluence/#plfa_plfa-part2-Confluence-3777" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-3779" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-3781" href="../Confluence/#plfa_plfa-part2-Confluence-3771" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-3783" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-3785" href="../Confluence/#plfa_plfa-part2-Confluence-3773" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3786" class="Symbol">)</a>
      <a id="plfa_plfa-part2-Confluence-3794" class="Comment">--------</a>
    <a id="plfa_plfa-part2-Confluence-3807" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-3809" href="../Confluence/#plfa_plfa-part2-Confluence-3777" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-3811" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-3814" href="../Confluence/#plfa_plfa-part2-Confluence-3777" class="Bound">M</a>

  <a id="plfa_plfa-part2-Confluence-_⇛*_._⇛⟨_⟩_"></a><a id="plfa_plfa-part2-Confluence-3819" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">_⇛⟨_⟩_</a> <a id="plfa_plfa-part2-Confluence-3826" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-3828" class="Symbol">∀</a> <a id="plfa_plfa-part2-Confluence-3830" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3831" href="../Confluence/#plfa_plfa-part2-Confluence-3831" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-3833" href="../Confluence/#plfa_plfa-part2-Confluence-3833" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3834" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-3836" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-3837" href="../Confluence/#plfa_plfa-part2-Confluence-3837" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-3839" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-3841" href="../Confluence/#plfa_plfa-part2-Confluence-3831" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-3843" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-3845" href="../Confluence/#plfa_plfa-part2-Confluence-3833" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3846" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-3848" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-3849" href="../Confluence/#plfa_plfa-part2-Confluence-3849" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-3851" href="../Confluence/#plfa_plfa-part2-Confluence-3851" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-3853" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-3855" href="../Confluence/#plfa_plfa-part2-Confluence-3831" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-3857" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-3859" href="../Confluence/#plfa_plfa-part2-Confluence-3833" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-3860" class="Symbol">}</a>
    <a id="plfa_plfa-part2-Confluence-3866" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-3868" href="../Confluence/#plfa_plfa-part2-Confluence-3837" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-3870" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-3872" href="../Confluence/#plfa_plfa-part2-Confluence-3849" class="Bound">M</a>
    <a id="plfa_plfa-part2-Confluence-3878" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-3880" href="../Confluence/#plfa_plfa-part2-Confluence-3849" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-3882" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-3885" href="../Confluence/#plfa_plfa-part2-Confluence-3851" class="Bound">N</a>
      <a id="plfa_plfa-part2-Confluence-3893" class="Comment">---------</a>
    <a id="plfa_plfa-part2-Confluence-3907" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-3909" href="../Confluence/#plfa_plfa-part2-Confluence-3837" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-3911" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-3914" href="../Confluence/#plfa_plfa-part2-Confluence-3851" class="Bound">N</a>
</pre><h4 id="exercise-par-diamond-eg-practice">Exercise <code>par-diamond-eg</code> (practice)</h4><p>Revisit the counter example to the diamond property for reduction by showing that the diamond property holds for parallel reduction in that case.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-4120" class="Comment">-- Your code goes here</a>
</pre><h2 id="equivalence-between-parallel-reduction-and-reduction">Equivalence between parallel reduction and reduction</h2><p>Here we prove that for any <code>M</code> and <code>N</code>, <code>M ⇛* N</code> if and only if <code>M —↠ N</code>. The only-if direction is particularly easy. We start by showing that if <code>M —→ N</code>, then <code>M ⇛ N</code>. The proof is by induction on the reduction <code>M —→ N</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-beta-par"></a><a id="plfa_plfa-part2-Confluence-4438" href="../Confluence/#plfa_plfa-part2-Confluence-4438" class="Function">beta-par</a> <a id="plfa_plfa-part2-Confluence-4447" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-4449" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-4451" href="../Confluence/#plfa_plfa-part2-Confluence-4451" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-4453" href="../Confluence/#plfa_plfa-part2-Confluence-4453" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-4454" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-4456" href="../Confluence/#plfa_plfa-part2-Confluence-4456" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-4458" href="../Confluence/#plfa_plfa-part2-Confluence-4458" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-4460" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-4462" href="../Confluence/#plfa_plfa-part2-Confluence-4451" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-4464" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-4466" href="../Confluence/#plfa_plfa-part2-Confluence-4453" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-4467" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-4471" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-4473" href="../Confluence/#plfa_plfa-part2-Confluence-4456" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-4475" href="../Untyped/#plfa_plfa-part2-Untyped-9956" class="Datatype Operator">—→</a> <a id="plfa_plfa-part2-Confluence-4478" href="../Confluence/#plfa_plfa-part2-Confluence-4458" class="Bound">N</a>
    <a id="plfa_plfa-part2-Confluence-4484" class="Comment">------</a>
  <a id="plfa_plfa-part2-Confluence-4493" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-4495" href="../Confluence/#plfa_plfa-part2-Confluence-4456" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-4497" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-4499" href="../Confluence/#plfa_plfa-part2-Confluence-4458" class="Bound">N</a>
<a id="plfa_plfa-part2-Confluence-4501" href="../Confluence/#plfa_plfa-part2-Confluence-4438" class="Function">beta-par</a> <a id="plfa_plfa-part2-Confluence-4510" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4511" href="../Confluence/#plfa_plfa-part2-Confluence-4511" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-4512" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4514" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4515" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-4516" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4518" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4519" href="../Confluence/#plfa_plfa-part2-Confluence-4519" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-4521" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-4523" href="../Confluence/#plfa_plfa-part2-Confluence-4523" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-4524" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4526" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-4527" href="../Untyped/#plfa_plfa-part2-Untyped-10006" class="InductiveConstructor">ξ₁</a> <a id="plfa_plfa-part2-Confluence-4530" href="../Confluence/#plfa_plfa-part2-Confluence-4530" class="Bound">r</a><a id="plfa_plfa-part2-Confluence-4531" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-4533" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-4535" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-4540" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-4541" href="../Confluence/#plfa_plfa-part2-Confluence-4438" class="Function">beta-par</a> <a id="plfa_plfa-part2-Confluence-4550" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4551" class="Argument">M</a> <a id="plfa_plfa-part2-Confluence-4553" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-4555" href="../Confluence/#plfa_plfa-part2-Confluence-4519" class="Bound">L</a><a id="plfa_plfa-part2-Confluence-4556" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4558" href="../Confluence/#plfa_plfa-part2-Confluence-4530" class="Bound">r</a><a id="plfa_plfa-part2-Confluence-4559" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-4561" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a>
<a id="plfa_plfa-part2-Confluence-4570" href="../Confluence/#plfa_plfa-part2-Confluence-4438" class="Function">beta-par</a> <a id="plfa_plfa-part2-Confluence-4579" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4580" href="../Confluence/#plfa_plfa-part2-Confluence-4580" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-4581" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4583" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4584" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-4585" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4587" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4588" href="../Confluence/#plfa_plfa-part2-Confluence-4588" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-4590" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-4592" href="../Confluence/#plfa_plfa-part2-Confluence-4592" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-4593" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4595" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-4596" href="../Untyped/#plfa_plfa-part2-Untyped-10096" class="InductiveConstructor">ξ₂</a> <a id="plfa_plfa-part2-Confluence-4599" href="../Confluence/#plfa_plfa-part2-Confluence-4599" class="Bound">r</a><a id="plfa_plfa-part2-Confluence-4600" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-4602" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-4604" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-4609" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a> <a id="plfa_plfa-part2-Confluence-4618" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-4619" href="../Confluence/#plfa_plfa-part2-Confluence-4438" class="Function">beta-par</a> <a id="plfa_plfa-part2-Confluence-4628" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4629" class="Argument">M</a> <a id="plfa_plfa-part2-Confluence-4631" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-4633" href="../Confluence/#plfa_plfa-part2-Confluence-4592" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-4634" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4636" href="../Confluence/#plfa_plfa-part2-Confluence-4599" class="Bound">r</a><a id="plfa_plfa-part2-Confluence-4637" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-4639" href="../Confluence/#plfa_plfa-part2-Confluence-4438" class="Function">beta-par</a> <a id="plfa_plfa-part2-Confluence-4648" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4649" href="../Confluence/#plfa_plfa-part2-Confluence-4649" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-4650" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4652" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4653" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-4654" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4656" class="Symbol">{(</a><a id="plfa_plfa-part2-Confluence-4658" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-4660" href="../Confluence/#plfa_plfa-part2-Confluence-4660" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-4661" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-4663" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-4665" href="../Confluence/#plfa_plfa-part2-Confluence-4665" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-4666" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4668" href="../Untyped/#plfa_plfa-part2-Untyped-10186" class="InductiveConstructor">β</a> <a id="plfa_plfa-part2-Confluence-4670" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-4672" href="../Confluence/#plfa_plfa-part2-Confluence-2901" class="InductiveConstructor">pbeta</a> <a id="plfa_plfa-part2-Confluence-4678" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a> <a id="plfa_plfa-part2-Confluence-4687" href="../Confluence/#plfa_plfa-part2-Confluence-3438" class="Function">par-refl</a>
<a id="plfa_plfa-part2-Confluence-4696" href="../Confluence/#plfa_plfa-part2-Confluence-4438" class="Function">beta-par</a> <a id="plfa_plfa-part2-Confluence-4705" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4706" href="../Confluence/#plfa_plfa-part2-Confluence-4706" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-4707" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4709" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4710" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-4711" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4713" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4714" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-4716" href="../Confluence/#plfa_plfa-part2-Confluence-4716" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-4717" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4719" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-4720" href="../Untyped/#plfa_plfa-part2-Untyped-10294" class="InductiveConstructor">ζ</a> <a id="plfa_plfa-part2-Confluence-4722" href="../Confluence/#plfa_plfa-part2-Confluence-4722" class="Bound">r</a><a id="plfa_plfa-part2-Confluence-4723" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-4725" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-4727" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-4732" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-4733" href="../Confluence/#plfa_plfa-part2-Confluence-4438" class="Function">beta-par</a> <a id="plfa_plfa-part2-Confluence-4742" href="../Confluence/#plfa_plfa-part2-Confluence-4722" class="Bound">r</a><a id="plfa_plfa-part2-Confluence-4743" class="Symbol">)</a>
</pre><p>With this lemma in hand we complete the only-if direction, that <code>M —↠ N</code> implies <code>M ⇛* N</code>. The proof is a straightforward induction on the reduction sequence <code>M —↠ N</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-betas-pars"></a><a id="plfa_plfa-part2-Confluence-4927" href="../Confluence/#plfa_plfa-part2-Confluence-4927" class="Function">betas-pars</a> <a id="plfa_plfa-part2-Confluence-4938" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-4940" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-4942" href="../Confluence/#plfa_plfa-part2-Confluence-4942" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-4944" href="../Confluence/#plfa_plfa-part2-Confluence-4944" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-4945" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-4947" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-4948" href="../Confluence/#plfa_plfa-part2-Confluence-4948" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-4950" href="../Confluence/#plfa_plfa-part2-Confluence-4950" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-4952" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-4954" href="../Confluence/#plfa_plfa-part2-Confluence-4942" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-4956" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-4958" href="../Confluence/#plfa_plfa-part2-Confluence-4944" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-4959" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-4963" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-4965" href="../Confluence/#plfa_plfa-part2-Confluence-4948" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-4967" href="../Untyped/#plfa_plfa-part2-Untyped-11088" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-Confluence-4970" href="../Confluence/#plfa_plfa-part2-Confluence-4950" class="Bound">N</a>
    <a id="plfa_plfa-part2-Confluence-4976" class="Comment">------</a>
  <a id="plfa_plfa-part2-Confluence-4985" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-4987" href="../Confluence/#plfa_plfa-part2-Confluence-4948" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-4989" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-4992" href="../Confluence/#plfa_plfa-part2-Confluence-4950" class="Bound">N</a>
<a id="plfa_plfa-part2-Confluence-4994" href="../Confluence/#plfa_plfa-part2-Confluence-4927" class="Function">betas-pars</a> <a id="plfa_plfa-part2-Confluence-5005" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5006" href="../Confluence/#plfa_plfa-part2-Confluence-5006" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-5007" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5009" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5010" href="../Confluence/#plfa_plfa-part2-Confluence-5010" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-5011" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5013" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5014" href="../Confluence/#plfa_plfa-part2-Confluence-5014" class="Bound">M₁</a><a id="plfa_plfa-part2-Confluence-5016" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5018" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5019" class="DottedPattern Symbol">.</a><a id="plfa_plfa-part2-Confluence-5020" href="../Confluence/#plfa_plfa-part2-Confluence-5014" class="DottedPattern Bound">M₁</a><a id="plfa_plfa-part2-Confluence-5022" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5024" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5025" href="../Confluence/#plfa_plfa-part2-Confluence-5014" class="Bound">M₁</a> <a id="plfa_plfa-part2-Confluence-5028" href="../Untyped/#plfa_plfa-part2-Untyped-11138" class="InductiveConstructor Operator">∎</a><a id="plfa_plfa-part2-Confluence-5029" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5031" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-5033" href="../Confluence/#plfa_plfa-part2-Confluence-5014" class="Bound">M₁</a> <a id="plfa_plfa-part2-Confluence-5036" href="../Confluence/#plfa_plfa-part2-Confluence-3763" class="InductiveConstructor Operator">∎</a>
<a id="plfa_plfa-part2-Confluence-5038" href="../Confluence/#plfa_plfa-part2-Confluence-4927" class="Function">betas-pars</a> <a id="plfa_plfa-part2-Confluence-5049" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5050" href="../Confluence/#plfa_plfa-part2-Confluence-5050" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-5051" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5053" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5054" href="../Confluence/#plfa_plfa-part2-Confluence-5054" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-5055" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5057" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5058" class="DottedPattern Symbol">.</a><a id="plfa_plfa-part2-Confluence-5059" href="../Confluence/#plfa_plfa-part2-Confluence-5067" class="DottedPattern Bound">L</a><a id="plfa_plfa-part2-Confluence-5060" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5062" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5063" href="../Confluence/#plfa_plfa-part2-Confluence-5063" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-5064" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5066" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5067" href="../Confluence/#plfa_plfa-part2-Confluence-5067" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-5069" href="../Untyped/#plfa_plfa-part2-Untyped-11194" class="InductiveConstructor Operator">—→⟨</a> <a id="plfa_plfa-part2-Confluence-5073" href="../Confluence/#plfa_plfa-part2-Confluence-5073" class="Bound">b</a> <a id="plfa_plfa-part2-Confluence-5075" href="../Untyped/#plfa_plfa-part2-Untyped-11194" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-5077" href="../Confluence/#plfa_plfa-part2-Confluence-5077" class="Bound">bs</a><a id="plfa_plfa-part2-Confluence-5079" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5081" class="Symbol">=</a>
   <a id="plfa_plfa-part2-Confluence-5086" href="../Confluence/#plfa_plfa-part2-Confluence-5067" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-5088" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⇛⟨</a> <a id="plfa_plfa-part2-Confluence-5091" href="../Confluence/#plfa_plfa-part2-Confluence-4438" class="Function">beta-par</a> <a id="plfa_plfa-part2-Confluence-5100" href="../Confluence/#plfa_plfa-part2-Confluence-5073" class="Bound">b</a> <a id="plfa_plfa-part2-Confluence-5102" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-5104" href="../Confluence/#plfa_plfa-part2-Confluence-4927" class="Function">betas-pars</a> <a id="plfa_plfa-part2-Confluence-5115" href="../Confluence/#plfa_plfa-part2-Confluence-5077" class="Bound">bs</a>
</pre><p>Now for the other direction, that <code>M ⇛* N</code> implies <code>M —↠ N</code>. The proof of this direction is a bit different because it’s not the case that <code>M ⇛ N</code> implies <code>M —→ N</code>. After all, <code>M ⇛ N</code> performs many reductions. So instead we shall prove that <code>M ⇛ N</code> implies <code>M —↠ N</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-par-betas"></a><a id="plfa_plfa-part2-Confluence-5400" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-5410" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-5412" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-5414" href="../Confluence/#plfa_plfa-part2-Confluence-5414" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-5416" href="../Confluence/#plfa_plfa-part2-Confluence-5416" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-5417" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-5419" href="../Confluence/#plfa_plfa-part2-Confluence-5419" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-5421" href="../Confluence/#plfa_plfa-part2-Confluence-5421" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-5423" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-5425" href="../Confluence/#plfa_plfa-part2-Confluence-5414" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-5427" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-5429" href="../Confluence/#plfa_plfa-part2-Confluence-5416" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-5430" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-5434" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-5436" href="../Confluence/#plfa_plfa-part2-Confluence-5419" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-5438" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-5440" href="../Confluence/#plfa_plfa-part2-Confluence-5421" class="Bound">N</a>
    <a id="plfa_plfa-part2-Confluence-5446" class="Comment">------</a>
  <a id="plfa_plfa-part2-Confluence-5455" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-5457" href="../Confluence/#plfa_plfa-part2-Confluence-5419" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-5459" href="../Untyped/#plfa_plfa-part2-Untyped-11088" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-Confluence-5462" href="../Confluence/#plfa_plfa-part2-Confluence-5421" class="Bound">N</a>
<a id="plfa_plfa-part2-Confluence-5464" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-5474" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5475" href="../Confluence/#plfa_plfa-part2-Confluence-5475" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-5476" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5478" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5479" href="../Confluence/#plfa_plfa-part2-Confluence-5479" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-5480" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5482" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5483" class="DottedPattern Symbol">.(</a><a id="plfa_plfa-part2-Confluence-5485" href="../Untyped/#plfa_plfa-part2-Untyped-4282" class="DottedPattern InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-Confluence-5487" class="DottedPattern Symbol">_)</a><a id="plfa_plfa-part2-Confluence-5489" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5491" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5492" href="../Confluence/#plfa_plfa-part2-Confluence-2651" class="InductiveConstructor">pvar</a><a id="plfa_plfa-part2-Confluence-5496" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5497" class="Argument">x</a> <a id="plfa_plfa-part2-Confluence-5499" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-5501" href="../Confluence/#plfa_plfa-part2-Confluence-5501" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-5502" class="Symbol">})</a> <a id="plfa_plfa-part2-Confluence-5505" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-5507" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5508" href="../Untyped/#plfa_plfa-part2-Untyped-4282" class="InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-Confluence-5510" href="../Confluence/#plfa_plfa-part2-Confluence-5501" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-5511" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5513" href="../Untyped/#plfa_plfa-part2-Untyped-11138" class="InductiveConstructor Operator">∎</a>
<a id="plfa_plfa-part2-Confluence-5515" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-5525" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5526" href="../Confluence/#plfa_plfa-part2-Confluence-5526" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-5527" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5529" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5530" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-5531" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5533" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5534" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-5536" href="../Confluence/#plfa_plfa-part2-Confluence-5536" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-5537" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5539" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5540" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-5545" href="../Confluence/#plfa_plfa-part2-Confluence-5545" class="Bound">p</a><a id="plfa_plfa-part2-Confluence-5546" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5548" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-5550" href="../Untyped/#plfa_plfa-part2-Untyped-23992" class="Function">abs-cong</a> <a id="plfa_plfa-part2-Confluence-5559" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5560" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-5570" href="../Confluence/#plfa_plfa-part2-Confluence-5545" class="Bound">p</a><a id="plfa_plfa-part2-Confluence-5571" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-5573" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-5583" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5584" href="../Confluence/#plfa_plfa-part2-Confluence-5584" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-5585" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5587" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5588" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-5589" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5591" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5592" href="../Confluence/#plfa_plfa-part2-Confluence-5592" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-5594" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-5596" href="../Confluence/#plfa_plfa-part2-Confluence-5596" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-5597" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5599" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5600" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-5605" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5606" class="Argument">L</a> <a id="plfa_plfa-part2-Confluence-5608" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-5610" href="../Confluence/#plfa_plfa-part2-Confluence-5592" class="Bound">L</a><a id="plfa_plfa-part2-Confluence-5611" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-5613" href="../Confluence/#plfa_plfa-part2-Confluence-5613" class="Bound">L′</a><a id="plfa_plfa-part2-Confluence-5615" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-5617" href="../Confluence/#plfa_plfa-part2-Confluence-5596" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-5618" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-5620" href="../Confluence/#plfa_plfa-part2-Confluence-5620" class="Bound">M′</a><a id="plfa_plfa-part2-Confluence-5622" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5624" href="../Confluence/#plfa_plfa-part2-Confluence-5624" class="Bound">p₁</a> <a id="plfa_plfa-part2-Confluence-5627" href="../Confluence/#plfa_plfa-part2-Confluence-5627" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-5629" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5631" class="Symbol">=</a>
    <a id="plfa_plfa-part2-Confluence-5637" href="../Untyped/#plfa_plfa-part2-Untyped-11294" class="Function Operator">begin</a>
    <a id="plfa_plfa-part2-Confluence-5647" href="../Confluence/#plfa_plfa-part2-Confluence-5592" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-5649" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-5651" href="../Confluence/#plfa_plfa-part2-Confluence-5596" class="Bound">M</a>   <a id="plfa_plfa-part2-Confluence-5655" href="../Untyped/#plfa_plfa-part2-Untyped-22087" class="Function Operator">—↠⟨</a> <a id="plfa_plfa-part2-Confluence-5659" href="../Untyped/#plfa_plfa-part2-Untyped-22987" class="Function">appL-cong</a><a id="plfa_plfa-part2-Confluence-5668" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5669" class="Argument">M</a> <a id="plfa_plfa-part2-Confluence-5671" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-5673" href="../Confluence/#plfa_plfa-part2-Confluence-5596" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-5674" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5676" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5677" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-5687" href="../Confluence/#plfa_plfa-part2-Confluence-5624" class="Bound">p₁</a><a id="plfa_plfa-part2-Confluence-5689" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5691" href="../Untyped/#plfa_plfa-part2-Untyped-22087" class="Function Operator">⟩</a>
    <a id="plfa_plfa-part2-Confluence-5697" href="../Confluence/#plfa_plfa-part2-Confluence-5613" class="Bound">L′</a> <a id="plfa_plfa-part2-Confluence-5700" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-5702" href="../Confluence/#plfa_plfa-part2-Confluence-5596" class="Bound">M</a>  <a id="plfa_plfa-part2-Confluence-5705" href="../Untyped/#plfa_plfa-part2-Untyped-22087" class="Function Operator">—↠⟨</a> <a id="plfa_plfa-part2-Confluence-5709" href="../Untyped/#plfa_plfa-part2-Untyped-23760" class="Function">appR-cong</a> <a id="plfa_plfa-part2-Confluence-5719" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5720" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-5730" href="../Confluence/#plfa_plfa-part2-Confluence-5627" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-5732" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5734" href="../Untyped/#plfa_plfa-part2-Untyped-22087" class="Function Operator">⟩</a>
    <a id="plfa_plfa-part2-Confluence-5740" href="../Confluence/#plfa_plfa-part2-Confluence-5613" class="Bound">L′</a> <a id="plfa_plfa-part2-Confluence-5743" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-5745" href="../Confluence/#plfa_plfa-part2-Confluence-5620" class="Bound">M′</a>
    <a id="plfa_plfa-part2-Confluence-5752" href="../Untyped/#plfa_plfa-part2-Untyped-11138" class="InductiveConstructor Operator">∎</a>
<a id="plfa_plfa-part2-Confluence-5754" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-5764" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5765" href="../Confluence/#plfa_plfa-part2-Confluence-5765" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-5766" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5768" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5769" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-5770" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5772" class="Symbol">{(</a><a id="plfa_plfa-part2-Confluence-5774" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-5776" href="../Confluence/#plfa_plfa-part2-Confluence-5776" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-5777" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5779" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-5781" href="../Confluence/#plfa_plfa-part2-Confluence-5781" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-5782" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5784" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5785" href="../Confluence/#plfa_plfa-part2-Confluence-2901" class="InductiveConstructor">pbeta</a><a id="plfa_plfa-part2-Confluence-5790" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5791" class="Argument">N′</a> <a id="plfa_plfa-part2-Confluence-5794" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-5796" href="../Confluence/#plfa_plfa-part2-Confluence-5796" class="Bound">N′</a><a id="plfa_plfa-part2-Confluence-5798" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-5800" class="Argument">M′</a> <a id="plfa_plfa-part2-Confluence-5803" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-5805" href="../Confluence/#plfa_plfa-part2-Confluence-5805" class="Bound">M′</a><a id="plfa_plfa-part2-Confluence-5807" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5809" href="../Confluence/#plfa_plfa-part2-Confluence-5809" class="Bound">p₁</a> <a id="plfa_plfa-part2-Confluence-5812" href="../Confluence/#plfa_plfa-part2-Confluence-5812" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-5814" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5816" class="Symbol">=</a>
    <a id="plfa_plfa-part2-Confluence-5822" href="../Untyped/#plfa_plfa-part2-Untyped-11294" class="Function Operator">begin</a>
    <a id="plfa_plfa-part2-Confluence-5832" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5833" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-5835" href="../Confluence/#plfa_plfa-part2-Confluence-5776" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-5836" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5838" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-5840" href="../Confluence/#plfa_plfa-part2-Confluence-5781" class="Bound">M</a>                    <a id="plfa_plfa-part2-Confluence-5861" href="../Untyped/#plfa_plfa-part2-Untyped-22087" class="Function Operator">—↠⟨</a> <a id="plfa_plfa-part2-Confluence-5865" href="../Untyped/#plfa_plfa-part2-Untyped-22987" class="Function">appL-cong</a><a id="plfa_plfa-part2-Confluence-5874" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5875" class="Argument">M</a> <a id="plfa_plfa-part2-Confluence-5877" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-5879" href="../Confluence/#plfa_plfa-part2-Confluence-5781" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-5880" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5882" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5883" href="../Untyped/#plfa_plfa-part2-Untyped-23992" class="Function">abs-cong</a> <a id="plfa_plfa-part2-Confluence-5892" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5893" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-5903" href="../Confluence/#plfa_plfa-part2-Confluence-5809" class="Bound">p₁</a><a id="plfa_plfa-part2-Confluence-5905" class="Symbol">))</a> <a id="plfa_plfa-part2-Confluence-5908" href="../Untyped/#plfa_plfa-part2-Untyped-22087" class="Function Operator">⟩</a>
    <a id="plfa_plfa-part2-Confluence-5914" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5915" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-5917" href="../Confluence/#plfa_plfa-part2-Confluence-5796" class="Bound">N′</a><a id="plfa_plfa-part2-Confluence-5919" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5921" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-5923" href="../Confluence/#plfa_plfa-part2-Confluence-5781" class="Bound">M</a>                   <a id="plfa_plfa-part2-Confluence-5943" href="../Untyped/#plfa_plfa-part2-Untyped-22087" class="Function Operator">—↠⟨</a> <a id="plfa_plfa-part2-Confluence-5947" href="../Untyped/#plfa_plfa-part2-Untyped-23760" class="Function">appR-cong</a><a id="plfa_plfa-part2-Confluence-5956" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-5957" class="Argument">L</a> <a id="plfa_plfa-part2-Confluence-5959" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-5961" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-5963" href="../Confluence/#plfa_plfa-part2-Confluence-5796" class="Bound">N′</a><a id="plfa_plfa-part2-Confluence-5965" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-5967" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5968" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-5978" href="../Confluence/#plfa_plfa-part2-Confluence-5812" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-5980" class="Symbol">)</a>  <a id="plfa_plfa-part2-Confluence-5983" href="../Untyped/#plfa_plfa-part2-Untyped-22087" class="Function Operator">⟩</a>
    <a id="plfa_plfa-part2-Confluence-5989" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-5990" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-5992" href="../Confluence/#plfa_plfa-part2-Confluence-5796" class="Bound">N′</a><a id="plfa_plfa-part2-Confluence-5994" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-5996" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-5998" href="../Confluence/#plfa_plfa-part2-Confluence-5805" class="Bound">M′</a>                  <a id="plfa_plfa-part2-Confluence-6018" href="../Untyped/#plfa_plfa-part2-Untyped-11194" class="InductiveConstructor Operator">—→⟨</a> <a id="plfa_plfa-part2-Confluence-6022" href="../Untyped/#plfa_plfa-part2-Untyped-10186" class="InductiveConstructor">β</a> <a id="plfa_plfa-part2-Confluence-6024" href="../Untyped/#plfa_plfa-part2-Untyped-11194" class="InductiveConstructor Operator">⟩</a>
     <a id="plfa_plfa-part2-Confluence-6031" href="../Confluence/#plfa_plfa-part2-Confluence-5796" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-6034" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">[</a> <a id="plfa_plfa-part2-Confluence-6036" href="../Confluence/#plfa_plfa-part2-Confluence-5805" class="Bound">M′</a> <a id="plfa_plfa-part2-Confluence-6039" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">]</a>
    <a id="plfa_plfa-part2-Confluence-6045" href="../Untyped/#plfa_plfa-part2-Untyped-11138" class="InductiveConstructor Operator">∎</a>
</pre><p>The proof is by induction on <code>M ⇛ N</code>.</p><ul><li><p>Suppose <code>x ⇛ x</code>. We immediately have <code>x —↠ x</code>.</p></li><li><p>Suppose <code>ƛ N ⇛ ƛ N′</code> because <code>N ⇛ N′</code>. By the induction hypothesis we have <code>N —↠ N′</code>. We conclude that <code>ƛ N —↠ ƛ N′</code> because <code>—↠</code> is a congruence.</p></li><li><p>Suppose <code>L · M ⇛ L′ · M′</code> because <code>L ⇛ L′</code> and <code>M ⇛ M′</code>. By the induction hypothesis, we have <code>L —↠ L′</code> and <code>M —↠ M′</code>. So <code>L · M —↠ L′ · M</code> and then <code>L′ · M —↠ L′ · M′</code> because <code>—↠</code> is a congruence.</p></li><li><p>Suppose <code>(ƛ N) · M ⇛ N′ [ M′ ]</code> because <code>N ⇛ N′</code> and <code>M ⇛ M′</code>. By similar reasoning, we have <code>(ƛ N) · M —↠ (ƛ N′) · M′</code> which we can following with the β reduction <code>(ƛ N′) · M′ —→ N′ [ M′ ]</code>.</p></li></ul><p>With this lemma in hand, we complete the proof that <code>M ⇛* N</code> implies <code>M —↠ N</code> with a simple induction on <code>M ⇛* N</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-pars-betas"></a><a id="plfa_plfa-part2-Confluence-6833" href="../Confluence/#plfa_plfa-part2-Confluence-6833" class="Function">pars-betas</a> <a id="plfa_plfa-part2-Confluence-6844" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-6846" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-6848" href="../Confluence/#plfa_plfa-part2-Confluence-6848" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-6850" href="../Confluence/#plfa_plfa-part2-Confluence-6850" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-6851" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-6853" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-6854" href="../Confluence/#plfa_plfa-part2-Confluence-6854" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-6856" href="../Confluence/#plfa_plfa-part2-Confluence-6856" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-6858" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-6860" href="../Confluence/#plfa_plfa-part2-Confluence-6848" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-6862" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-6864" href="../Confluence/#plfa_plfa-part2-Confluence-6850" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-6865" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-6869" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-6871" href="../Confluence/#plfa_plfa-part2-Confluence-6854" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-6873" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-6876" href="../Confluence/#plfa_plfa-part2-Confluence-6856" class="Bound">N</a>
    <a id="plfa_plfa-part2-Confluence-6882" class="Comment">------</a>
  <a id="plfa_plfa-part2-Confluence-6891" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-6893" href="../Confluence/#plfa_plfa-part2-Confluence-6854" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-6895" href="../Untyped/#plfa_plfa-part2-Untyped-11088" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-Confluence-6898" href="../Confluence/#plfa_plfa-part2-Confluence-6856" class="Bound">N</a>
<a id="plfa_plfa-part2-Confluence-6900" href="../Confluence/#plfa_plfa-part2-Confluence-6833" class="Function">pars-betas</a> <a id="plfa_plfa-part2-Confluence-6911" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-6912" href="../Confluence/#plfa_plfa-part2-Confluence-6912" class="Bound">M₁</a> <a id="plfa_plfa-part2-Confluence-6915" href="../Confluence/#plfa_plfa-part2-Confluence-3763" class="InductiveConstructor Operator">∎</a><a id="plfa_plfa-part2-Confluence-6916" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-6918" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-6920" href="../Confluence/#plfa_plfa-part2-Confluence-6912" class="Bound">M₁</a> <a id="plfa_plfa-part2-Confluence-6923" href="../Untyped/#plfa_plfa-part2-Untyped-11138" class="InductiveConstructor Operator">∎</a>
<a id="plfa_plfa-part2-Confluence-6925" href="../Confluence/#plfa_plfa-part2-Confluence-6833" class="Function">pars-betas</a> <a id="plfa_plfa-part2-Confluence-6936" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-6937" href="../Confluence/#plfa_plfa-part2-Confluence-6937" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-6939" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⇛⟨</a> <a id="plfa_plfa-part2-Confluence-6942" href="../Confluence/#plfa_plfa-part2-Confluence-6942" class="Bound">p</a> <a id="plfa_plfa-part2-Confluence-6944" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-6946" href="../Confluence/#plfa_plfa-part2-Confluence-6946" class="Bound">ps</a><a id="plfa_plfa-part2-Confluence-6948" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-6950" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-6952" href="../Untyped/#plfa_plfa-part2-Untyped-21813" class="Function">—↠-trans</a> <a id="plfa_plfa-part2-Confluence-6961" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-6962" href="../Confluence/#plfa_plfa-part2-Confluence-5400" class="Function">par-betas</a> <a id="plfa_plfa-part2-Confluence-6972" href="../Confluence/#plfa_plfa-part2-Confluence-6942" class="Bound">p</a><a id="plfa_plfa-part2-Confluence-6973" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-6975" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-6976" href="../Confluence/#plfa_plfa-part2-Confluence-6833" class="Function">pars-betas</a> <a id="plfa_plfa-part2-Confluence-6987" href="../Confluence/#plfa_plfa-part2-Confluence-6946" class="Bound">ps</a><a id="plfa_plfa-part2-Confluence-6989" class="Symbol">)</a>
</pre><h2 id="substitution-lemma-for-parallel-reduction">Substitution lemma for parallel reduction</h2><p>Our next goal is to prove the diamond property for parallel reduction. But to do that, we need to prove that substitution respects parallel reduction. That is, if <code>N ⇛ N′</code> and <code>M ⇛ M′</code>, then <code>N [ M ] ⇛ N′ [ M′ ]</code>. We cannot prove this directly by induction, so we generalize it to: if <code>N ⇛ N′</code> and the substitution <code>σ</code> pointwise parallel reduces to <code>τ</code>, then <code>subst σ N ⇛ subst τ N′</code>. We define the notion of pointwise parallel reduction as follows.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-par-subst"></a><a id="plfa_plfa-part2-Confluence-7502" href="../Confluence/#plfa_plfa-part2-Confluence-7502" class="Function">par-subst</a> <a id="plfa_plfa-part2-Confluence-7512" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-7514" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-7516" href="../Confluence/#plfa_plfa-part2-Confluence-7516" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-7518" href="../Confluence/#plfa_plfa-part2-Confluence-7518" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-7519" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-7521" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-7523" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-Confluence-7529" href="../Confluence/#plfa_plfa-part2-Confluence-7516" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-7531" href="../Confluence/#plfa_plfa-part2-Confluence-7518" class="Bound">Δ</a> <a id="plfa_plfa-part2-Confluence-7533" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-7535" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-Confluence-7541" href="../Confluence/#plfa_plfa-part2-Confluence-7516" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-7543" href="../Confluence/#plfa_plfa-part2-Confluence-7518" class="Bound">Δ</a> <a id="plfa_plfa-part2-Confluence-7545" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-7547" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="plfa_plfa-part2-Confluence-7551" href="../Confluence/#plfa_plfa-part2-Confluence-7502" class="Function">par-subst</a> <a id="plfa_plfa-part2-Confluence-7561" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-7562" href="../Confluence/#plfa_plfa-part2-Confluence-7562" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-7563" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-7565" href="../Confluence/#plfa_plfa-part2-Confluence-7565" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-7566" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-7568" href="../Confluence/#plfa_plfa-part2-Confluence-7568" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-7570" href="../Confluence/#plfa_plfa-part2-Confluence-7570" class="Bound">σ′</a> <a id="plfa_plfa-part2-Confluence-7573" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-7575" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-7577" href="../Confluence/#plfa_plfa-part2-Confluence-7577" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-7578" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-7580" href="../Confluence/#plfa_plfa-part2-Confluence-7580" class="Bound">x</a> <a id="plfa_plfa-part2-Confluence-7582" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-7584" href="../Confluence/#plfa_plfa-part2-Confluence-7562" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-7586" href="../Untyped/#plfa_plfa-part2-Untyped-3469" class="Datatype Operator">∋</a> <a id="plfa_plfa-part2-Confluence-7588" href="../Confluence/#plfa_plfa-part2-Confluence-7577" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-7589" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-7591" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-7593" href="../Confluence/#plfa_plfa-part2-Confluence-7568" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-7595" href="../Confluence/#plfa_plfa-part2-Confluence-7580" class="Bound">x</a> <a id="plfa_plfa-part2-Confluence-7597" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-7599" href="../Confluence/#plfa_plfa-part2-Confluence-7570" class="Bound">σ′</a> <a id="plfa_plfa-part2-Confluence-7602" href="../Confluence/#plfa_plfa-part2-Confluence-7580" class="Bound">x</a>
</pre><p>Because substitution depends on the extension function <code>exts</code>, which in turn relies on <code>rename</code>, we start with a version of the substitution lemma, called <code>par-rename</code>, that is specialized to renamings. The proof of <code>par-rename</code> relies on the fact that renaming and substitution commute with one another, which is a lemma that we import from Chapter <a href="../Substitution/">Substitution</a> and restate here.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-rename-subst-commute"></a><a id="plfa_plfa-part2-Confluence-8018" href="../Confluence/#plfa_plfa-part2-Confluence-8018" class="Function">rename-subst-commute</a> <a id="plfa_plfa-part2-Confluence-8039" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-8041" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-8043" href="../Confluence/#plfa_plfa-part2-Confluence-8043" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-8045" href="../Confluence/#plfa_plfa-part2-Confluence-8045" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-8046" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8048" href="../Confluence/#plfa_plfa-part2-Confluence-8048" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-8050" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-8052" href="../Confluence/#plfa_plfa-part2-Confluence-8043" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-8054" href="../Untyped/#plfa_plfa-part2-Untyped-3131" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-8056" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-Confluence-8058" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-8060" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-8061" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8063" href="../Confluence/#plfa_plfa-part2-Confluence-8063" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-8065" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-8067" href="../Confluence/#plfa_plfa-part2-Confluence-8043" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-8069" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-8071" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-8072" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8074" href="../Confluence/#plfa_plfa-part2-Confluence-8074" class="Bound">ρ</a> <a id="plfa_plfa-part2-Confluence-8076" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-8078" href="../Substitution/#plfa_plfa-part2-Substitution-2124" class="Function">Rename</a> <a id="plfa_plfa-part2-Confluence-8085" href="../Confluence/#plfa_plfa-part2-Confluence-8043" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-8087" href="../Confluence/#plfa_plfa-part2-Confluence-8045" class="Bound">Δ</a> <a id="plfa_plfa-part2-Confluence-8089" class="Symbol">}</a>
    <a id="plfa_plfa-part2-Confluence-8095" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-8097" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8098" href="../Untyped/#plfa_plfa-part2-Untyped-6207" class="Function">rename</a> <a id="plfa_plfa-part2-Confluence-8105" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8106" href="../Untyped/#plfa_plfa-part2-Untyped-5893" class="Function">ext</a> <a id="plfa_plfa-part2-Confluence-8110" href="../Confluence/#plfa_plfa-part2-Confluence-8074" class="Bound">ρ</a><a id="plfa_plfa-part2-Confluence-8111" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-8113" href="../Confluence/#plfa_plfa-part2-Confluence-8048" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-8114" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-8116" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">[</a> <a id="plfa_plfa-part2-Confluence-8118" href="../Untyped/#plfa_plfa-part2-Untyped-6207" class="Function">rename</a> <a id="plfa_plfa-part2-Confluence-8125" href="../Confluence/#plfa_plfa-part2-Confluence-8074" class="Bound">ρ</a> <a id="plfa_plfa-part2-Confluence-8127" href="../Confluence/#plfa_plfa-part2-Confluence-8063" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-8129" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">]</a> <a id="plfa_plfa-part2-Confluence-8131" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-Confluence-8133" href="../Untyped/#plfa_plfa-part2-Untyped-6207" class="Function">rename</a> <a id="plfa_plfa-part2-Confluence-8140" href="../Confluence/#plfa_plfa-part2-Confluence-8074" class="Bound">ρ</a> <a id="plfa_plfa-part2-Confluence-8142" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8143" href="../Confluence/#plfa_plfa-part2-Confluence-8048" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-8145" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">[</a> <a id="plfa_plfa-part2-Confluence-8147" href="../Confluence/#plfa_plfa-part2-Confluence-8063" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-8149" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">]</a><a id="plfa_plfa-part2-Confluence-8150" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-8152" href="../Confluence/#plfa_plfa-part2-Confluence-8018" class="Function">rename-subst-commute</a> <a id="plfa_plfa-part2-Confluence-8173" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-8174" class="Argument">N</a> <a id="plfa_plfa-part2-Confluence-8176" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-8178" href="../Confluence/#plfa_plfa-part2-Confluence-8178" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-8179" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-8181" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-8183" href="../Substitution/#plfa_plfa-part2-Substitution-27863" class="Function">plfa.part2.Substitution.rename-subst-commute</a> <a id="plfa_plfa-part2-Confluence-8228" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-8229" class="Argument">N</a> <a id="plfa_plfa-part2-Confluence-8231" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-8233" href="../Confluence/#plfa_plfa-part2-Confluence-8178" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-8234" class="Symbol">}</a>
</pre><p>Now for the <code>par-rename</code> lemma.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-par-rename"></a><a id="plfa_plfa-part2-Confluence-8282" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a> <a id="plfa_plfa-part2-Confluence-8293" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-8295" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-8297" href="../Confluence/#plfa_plfa-part2-Confluence-8297" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-8299" href="../Confluence/#plfa_plfa-part2-Confluence-8299" class="Bound">Δ</a> <a id="plfa_plfa-part2-Confluence-8301" href="../Confluence/#plfa_plfa-part2-Confluence-8301" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-8302" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-8304" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-8305" href="../Confluence/#plfa_plfa-part2-Confluence-8305" class="Bound">ρ</a> <a id="plfa_plfa-part2-Confluence-8307" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-8309" href="../Substitution/#plfa_plfa-part2-Substitution-2124" class="Function">Rename</a> <a id="plfa_plfa-part2-Confluence-8316" href="../Confluence/#plfa_plfa-part2-Confluence-8297" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-8318" href="../Confluence/#plfa_plfa-part2-Confluence-8299" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-8319" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-8321" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-8322" href="../Confluence/#plfa_plfa-part2-Confluence-8322" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-8324" href="../Confluence/#plfa_plfa-part2-Confluence-8324" class="Bound">M′</a> <a id="plfa_plfa-part2-Confluence-8327" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-8329" href="../Confluence/#plfa_plfa-part2-Confluence-8297" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-8331" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-8333" href="../Confluence/#plfa_plfa-part2-Confluence-8301" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-8334" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-8338" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-8340" href="../Confluence/#plfa_plfa-part2-Confluence-8322" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-8342" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-8344" href="../Confluence/#plfa_plfa-part2-Confluence-8324" class="Bound">M′</a>
    <a id="plfa_plfa-part2-Confluence-8351" class="Comment">------------------------</a>
  <a id="plfa_plfa-part2-Confluence-8378" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-8380" href="../Untyped/#plfa_plfa-part2-Untyped-6207" class="Function">rename</a> <a id="plfa_plfa-part2-Confluence-8387" href="../Confluence/#plfa_plfa-part2-Confluence-8305" class="Bound">ρ</a> <a id="plfa_plfa-part2-Confluence-8389" href="../Confluence/#plfa_plfa-part2-Confluence-8322" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-8391" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-8393" href="../Untyped/#plfa_plfa-part2-Untyped-6207" class="Function">rename</a> <a id="plfa_plfa-part2-Confluence-8400" href="../Confluence/#plfa_plfa-part2-Confluence-8305" class="Bound">ρ</a> <a id="plfa_plfa-part2-Confluence-8402" href="../Confluence/#plfa_plfa-part2-Confluence-8324" class="Bound">M′</a>
<a id="plfa_plfa-part2-Confluence-8405" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a> <a id="plfa_plfa-part2-Confluence-8416" href="../Confluence/#plfa_plfa-part2-Confluence-2651" class="InductiveConstructor">pvar</a> <a id="plfa_plfa-part2-Confluence-8421" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-8423" href="../Confluence/#plfa_plfa-part2-Confluence-2651" class="InductiveConstructor">pvar</a>
<a id="plfa_plfa-part2-Confluence-8428" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a> <a id="plfa_plfa-part2-Confluence-8439" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8440" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-8445" href="../Confluence/#plfa_plfa-part2-Confluence-8445" class="Bound">p</a><a id="plfa_plfa-part2-Confluence-8446" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-8448" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-8450" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-8455" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8456" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a> <a id="plfa_plfa-part2-Confluence-8467" href="../Confluence/#plfa_plfa-part2-Confluence-8445" class="Bound">p</a><a id="plfa_plfa-part2-Confluence-8468" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-8470" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a> <a id="plfa_plfa-part2-Confluence-8481" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8482" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-8487" href="../Confluence/#plfa_plfa-part2-Confluence-8487" class="Bound">p₁</a> <a id="plfa_plfa-part2-Confluence-8490" href="../Confluence/#plfa_plfa-part2-Confluence-8490" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-8492" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-8494" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-8496" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-8501" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8502" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a> <a id="plfa_plfa-part2-Confluence-8513" href="../Confluence/#plfa_plfa-part2-Confluence-8487" class="Bound">p₁</a><a id="plfa_plfa-part2-Confluence-8515" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-8517" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8518" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a> <a id="plfa_plfa-part2-Confluence-8529" href="../Confluence/#plfa_plfa-part2-Confluence-8490" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-8531" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-8533" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a> <a id="plfa_plfa-part2-Confluence-8544" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-8545" href="../Confluence/#plfa_plfa-part2-Confluence-8545" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-8546" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8548" href="../Confluence/#plfa_plfa-part2-Confluence-8548" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-8549" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8551" href="../Confluence/#plfa_plfa-part2-Confluence-8551" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-8552" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8554" href="../Confluence/#plfa_plfa-part2-Confluence-8554" class="Bound">ρ</a><a id="plfa_plfa-part2-Confluence-8555" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-8557" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8558" href="../Confluence/#plfa_plfa-part2-Confluence-2901" class="InductiveConstructor">pbeta</a><a id="plfa_plfa-part2-Confluence-8563" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-8564" href="../Confluence/#plfa_plfa-part2-Confluence-8545" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-8565" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8567" href="../Confluence/#plfa_plfa-part2-Confluence-8567" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-8568" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8570" href="../Confluence/#plfa_plfa-part2-Confluence-8570" class="Bound">N′</a><a id="plfa_plfa-part2-Confluence-8572" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8574" href="../Confluence/#plfa_plfa-part2-Confluence-8574" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-8575" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8577" href="../Confluence/#plfa_plfa-part2-Confluence-8577" class="Bound">M′</a><a id="plfa_plfa-part2-Confluence-8579" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-8581" href="../Confluence/#plfa_plfa-part2-Confluence-8581" class="Bound">p₁</a> <a id="plfa_plfa-part2-Confluence-8584" href="../Confluence/#plfa_plfa-part2-Confluence-8584" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-8586" class="Symbol">)</a>
    <a id="plfa_plfa-part2-Confluence-8592" class="Keyword">with</a> <a id="plfa_plfa-part2-Confluence-8597" href="../Confluence/#plfa_plfa-part2-Confluence-2901" class="InductiveConstructor">pbeta</a> <a id="plfa_plfa-part2-Confluence-8603" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8604" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a><a id="plfa_plfa-part2-Confluence-8614" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-8615" class="Argument">ρ</a> <a id="plfa_plfa-part2-Confluence-8617" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-8619" href="../Untyped/#plfa_plfa-part2-Untyped-5893" class="Function">ext</a> <a id="plfa_plfa-part2-Confluence-8623" href="../Confluence/#plfa_plfa-part2-Confluence-8554" class="Bound">ρ</a><a id="plfa_plfa-part2-Confluence-8624" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-8626" href="../Confluence/#plfa_plfa-part2-Confluence-8581" class="Bound">p₁</a><a id="plfa_plfa-part2-Confluence-8628" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-8630" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-8631" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a><a id="plfa_plfa-part2-Confluence-8641" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-8642" class="Argument">ρ</a> <a id="plfa_plfa-part2-Confluence-8644" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-8646" href="../Confluence/#plfa_plfa-part2-Confluence-8554" class="Bound">ρ</a><a id="plfa_plfa-part2-Confluence-8647" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-8649" href="../Confluence/#plfa_plfa-part2-Confluence-8584" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-8651" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-8653" class="Symbol">...</a> <a id="plfa_plfa-part2-Confluence-8657" class="Symbol">|</a> <a id="plfa_plfa-part2-Confluence-8659" href="../Confluence/#plfa_plfa-part2-Confluence-8659" class="Bound">G</a> <a id="plfa_plfa-part2-Confluence-8661" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-Confluence-8669" href="../Confluence/#plfa_plfa-part2-Confluence-8018" class="Function">rename-subst-commute</a><a id="plfa_plfa-part2-Confluence-8689" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-8690" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-8691" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8693" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-8694" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8696" class="Bound">N′</a><a id="plfa_plfa-part2-Confluence-8698" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8700" class="Bound">M′</a><a id="plfa_plfa-part2-Confluence-8702" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-8704" class="Bound">ρ</a><a id="plfa_plfa-part2-Confluence-8705" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-8707" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-8709" href="../Confluence/#plfa_plfa-part2-Confluence-8659" class="Bound">G</a>

</pre><p>The proof is by induction on <code>M ⇛ M′</code>. The first three cases are straightforward so we just consider the last one for <code>pbeta</code>.</p><ul><li>Suppose <code>(ƛ N) · M ⇛ N′ [ M′ ]</code> because <code>N ⇛ N′</code> and <code>M ⇛ M′</code>. By the induction hypothesis, we have <code>rename (ext ρ) N ⇛ rename (ext ρ) N′</code> and <code>rename ρ M ⇛ rename ρ M′</code>. So by <code>pbeta</code> we have <code>(ƛ rename (ext ρ) N) · (rename ρ M) ⇛ (rename (ext ρ) N) [ rename ρ M ]</code>. However, to conclude we instead need parallel reduction to <code>rename ρ (N [ M ])</code>. But thankfully, renaming and substitution commute with one another.</li></ul><p>With the <code>par-rename</code> lemma in hand, it is straightforward to show that extending substitutions preserves the pointwise parallel reduction relation.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-par-subst-exts"></a><a id="plfa_plfa-part2-Confluence-9442" href="../Confluence/#plfa_plfa-part2-Confluence-9442" class="Function">par-subst-exts</a> <a id="plfa_plfa-part2-Confluence-9457" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-9459" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-9461" href="../Confluence/#plfa_plfa-part2-Confluence-9461" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-9463" href="../Confluence/#plfa_plfa-part2-Confluence-9463" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-9464" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-9466" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-9467" href="../Confluence/#plfa_plfa-part2-Confluence-9467" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-9469" href="../Confluence/#plfa_plfa-part2-Confluence-9469" class="Bound">τ</a> <a id="plfa_plfa-part2-Confluence-9471" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-9473" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-Confluence-9479" href="../Confluence/#plfa_plfa-part2-Confluence-9461" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-9481" href="../Confluence/#plfa_plfa-part2-Confluence-9463" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-9482" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-9486" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-9488" href="../Confluence/#plfa_plfa-part2-Confluence-7502" class="Function">par-subst</a> <a id="plfa_plfa-part2-Confluence-9498" href="../Confluence/#plfa_plfa-part2-Confluence-9467" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-9500" href="../Confluence/#plfa_plfa-part2-Confluence-9469" class="Bound">τ</a>
    <a id="plfa_plfa-part2-Confluence-9506" class="Comment">------------------------------------------</a>
  <a id="plfa_plfa-part2-Confluence-9551" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-9553" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-9555" href="../Confluence/#plfa_plfa-part2-Confluence-9555" class="Bound">B</a><a id="plfa_plfa-part2-Confluence-9556" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-9558" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-9560" href="../Confluence/#plfa_plfa-part2-Confluence-7502" class="Function">par-subst</a> <a id="plfa_plfa-part2-Confluence-9570" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-9571" href="../Untyped/#plfa_plfa-part2-Untyped-6647" class="Function">exts</a> <a id="plfa_plfa-part2-Confluence-9576" href="../Confluence/#plfa_plfa-part2-Confluence-9467" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-9578" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-9579" class="Argument">B</a> <a id="plfa_plfa-part2-Confluence-9581" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-9583" href="../Confluence/#plfa_plfa-part2-Confluence-9555" class="Bound">B</a><a id="plfa_plfa-part2-Confluence-9584" class="Symbol">})</a> <a id="plfa_plfa-part2-Confluence-9587" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-9588" href="../Untyped/#plfa_plfa-part2-Untyped-6647" class="Function">exts</a> <a id="plfa_plfa-part2-Confluence-9593" href="../Confluence/#plfa_plfa-part2-Confluence-9469" class="Bound">τ</a><a id="plfa_plfa-part2-Confluence-9594" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-9596" href="../Confluence/#plfa_plfa-part2-Confluence-9442" class="Function">par-subst-exts</a> <a id="plfa_plfa-part2-Confluence-9611" href="../Confluence/#plfa_plfa-part2-Confluence-9611" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-9613" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-9614" class="Argument">x</a> <a id="plfa_plfa-part2-Confluence-9616" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-9618" href="../Untyped/#plfa_plfa-part2-Untyped-3505" class="InductiveConstructor">Z</a><a id="plfa_plfa-part2-Confluence-9619" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-9621" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-9623" href="../Confluence/#plfa_plfa-part2-Confluence-2651" class="InductiveConstructor">pvar</a>
<a id="plfa_plfa-part2-Confluence-9628" href="../Confluence/#plfa_plfa-part2-Confluence-9442" class="Function">par-subst-exts</a> <a id="plfa_plfa-part2-Confluence-9643" href="../Confluence/#plfa_plfa-part2-Confluence-9643" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-9645" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-9646" class="Argument">x</a> <a id="plfa_plfa-part2-Confluence-9648" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-9650" href="../Untyped/#plfa_plfa-part2-Untyped-3550" class="InductiveConstructor Operator">S</a> <a id="plfa_plfa-part2-Confluence-9652" href="../Confluence/#plfa_plfa-part2-Confluence-9652" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-9653" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-9655" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-9657" href="../Confluence/#plfa_plfa-part2-Confluence-8282" class="Function">par-rename</a> <a id="plfa_plfa-part2-Confluence-9668" href="../Confluence/#plfa_plfa-part2-Confluence-9643" class="Bound">s</a>
</pre><p>The next lemma that we need for proving that substitution respects parallel reduction is the following which states that simultaneous substitution commutes with single substitution. We import this lemma from Chapter <a href="../Substitution/">Substitution</a> and restate it below.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-subst-commute"></a><a id="plfa_plfa-part2-Confluence-9953" href="../Confluence/#plfa_plfa-part2-Confluence-9953" class="Function">subst-commute</a> <a id="plfa_plfa-part2-Confluence-9967" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-9969" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-9971" href="../Confluence/#plfa_plfa-part2-Confluence-9971" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-9973" href="../Confluence/#plfa_plfa-part2-Confluence-9973" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-9974" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-9976" href="../Confluence/#plfa_plfa-part2-Confluence-9976" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-9978" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-9980" href="../Confluence/#plfa_plfa-part2-Confluence-9971" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-9982" href="../Untyped/#plfa_plfa-part2-Untyped-3131" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-9984" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-Confluence-9986" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-9988" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-9989" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-9991" href="../Confluence/#plfa_plfa-part2-Confluence-9991" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-9993" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-9995" href="../Confluence/#plfa_plfa-part2-Confluence-9971" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-9997" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-9999" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-10000" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-10002" href="../Confluence/#plfa_plfa-part2-Confluence-10002" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-10004" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-10006" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-Confluence-10012" href="../Confluence/#plfa_plfa-part2-Confluence-9971" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-10014" href="../Confluence/#plfa_plfa-part2-Confluence-9973" class="Bound">Δ</a> <a id="plfa_plfa-part2-Confluence-10016" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-10020" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-10022" href="../Untyped/#plfa_plfa-part2-Untyped-6943" class="Function">subst</a> <a id="plfa_plfa-part2-Confluence-10028" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-10029" href="../Untyped/#plfa_plfa-part2-Untyped-6647" class="Function">exts</a> <a id="plfa_plfa-part2-Confluence-10034" href="../Confluence/#plfa_plfa-part2-Confluence-10002" class="Bound">σ</a><a id="plfa_plfa-part2-Confluence-10035" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-10037" href="../Confluence/#plfa_plfa-part2-Confluence-9976" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-10039" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">[</a> <a id="plfa_plfa-part2-Confluence-10041" href="../Untyped/#plfa_plfa-part2-Untyped-6943" class="Function">subst</a> <a id="plfa_plfa-part2-Confluence-10047" href="../Confluence/#plfa_plfa-part2-Confluence-10002" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-10049" href="../Confluence/#plfa_plfa-part2-Confluence-9991" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-10051" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">]</a> <a id="plfa_plfa-part2-Confluence-10053" href="https://agda.github.io/agda-stdlib/v1.7.1/Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-Confluence-10055" href="../Untyped/#plfa_plfa-part2-Untyped-6943" class="Function">subst</a> <a id="plfa_plfa-part2-Confluence-10061" href="../Confluence/#plfa_plfa-part2-Confluence-10002" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-10063" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-10064" href="../Confluence/#plfa_plfa-part2-Confluence-9976" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-10066" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">[</a> <a id="plfa_plfa-part2-Confluence-10068" href="../Confluence/#plfa_plfa-part2-Confluence-9991" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-10070" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">]</a><a id="plfa_plfa-part2-Confluence-10071" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-10073" href="../Confluence/#plfa_plfa-part2-Confluence-9953" class="Function">subst-commute</a> <a id="plfa_plfa-part2-Confluence-10087" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10088" class="Argument">N</a> <a id="plfa_plfa-part2-Confluence-10090" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10092" href="../Confluence/#plfa_plfa-part2-Confluence-10092" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-10093" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10095" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10097" href="../Substitution/#plfa_plfa-part2-Substitution-26318" class="Function">plfa.part2.Substitution.subst-commute</a> <a id="plfa_plfa-part2-Confluence-10135" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10136" class="Argument">N</a> <a id="plfa_plfa-part2-Confluence-10138" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10140" href="../Confluence/#plfa_plfa-part2-Confluence-10092" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-10141" class="Symbol">}</a>
</pre><p>We are ready to prove that substitution respects parallel reduction.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-subst-par"></a><a id="plfa_plfa-part2-Confluence-10226" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a> <a id="plfa_plfa-part2-Confluence-10236" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-10238" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-10240" href="../Confluence/#plfa_plfa-part2-Confluence-10240" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-10242" href="../Confluence/#plfa_plfa-part2-Confluence-10242" class="Bound">Δ</a> <a id="plfa_plfa-part2-Confluence-10244" href="../Confluence/#plfa_plfa-part2-Confluence-10244" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-10245" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10247" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10248" href="../Confluence/#plfa_plfa-part2-Confluence-10248" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-10250" href="../Confluence/#plfa_plfa-part2-Confluence-10250" class="Bound">τ</a> <a id="plfa_plfa-part2-Confluence-10252" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-10254" href="../Substitution/#plfa_plfa-part2-Substitution-2341" class="Function">Subst</a> <a id="plfa_plfa-part2-Confluence-10260" href="../Confluence/#plfa_plfa-part2-Confluence-10240" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-10262" href="../Confluence/#plfa_plfa-part2-Confluence-10242" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-10263" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10265" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10266" href="../Confluence/#plfa_plfa-part2-Confluence-10266" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-10268" href="../Confluence/#plfa_plfa-part2-Confluence-10268" class="Bound">M′</a> <a id="plfa_plfa-part2-Confluence-10271" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-10273" href="../Confluence/#plfa_plfa-part2-Confluence-10240" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-10275" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-10277" href="../Confluence/#plfa_plfa-part2-Confluence-10244" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-10278" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-10282" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-10284" href="../Confluence/#plfa_plfa-part2-Confluence-7502" class="Function">par-subst</a> <a id="plfa_plfa-part2-Confluence-10294" href="../Confluence/#plfa_plfa-part2-Confluence-10248" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-10296" href="../Confluence/#plfa_plfa-part2-Confluence-10250" class="Bound">τ</a>  <a id="plfa_plfa-part2-Confluence-10299" class="Symbol">→</a>  <a id="plfa_plfa-part2-Confluence-10302" href="../Confluence/#plfa_plfa-part2-Confluence-10266" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-10304" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-10306" href="../Confluence/#plfa_plfa-part2-Confluence-10268" class="Bound">M′</a>
    <a id="plfa_plfa-part2-Confluence-10313" class="Comment">--------------------------</a>
  <a id="plfa_plfa-part2-Confluence-10342" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-10344" href="../Untyped/#plfa_plfa-part2-Untyped-6943" class="Function">subst</a> <a id="plfa_plfa-part2-Confluence-10350" href="../Confluence/#plfa_plfa-part2-Confluence-10248" class="Bound">σ</a> <a id="plfa_plfa-part2-Confluence-10352" href="../Confluence/#plfa_plfa-part2-Confluence-10266" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-10354" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-10356" href="../Untyped/#plfa_plfa-part2-Untyped-6943" class="Function">subst</a> <a id="plfa_plfa-part2-Confluence-10362" href="../Confluence/#plfa_plfa-part2-Confluence-10250" class="Bound">τ</a> <a id="plfa_plfa-part2-Confluence-10364" href="../Confluence/#plfa_plfa-part2-Confluence-10268" class="Bound">M′</a>
<a id="plfa_plfa-part2-Confluence-10367" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a> <a id="plfa_plfa-part2-Confluence-10377" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10378" href="../Confluence/#plfa_plfa-part2-Confluence-10378" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-10379" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10381" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10382" href="../Confluence/#plfa_plfa-part2-Confluence-10382" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-10383" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10385" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10386" href="../Confluence/#plfa_plfa-part2-Confluence-10386" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-10387" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10389" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10390" href="../Confluence/#plfa_plfa-part2-Confluence-10390" class="Bound">σ</a><a id="plfa_plfa-part2-Confluence-10391" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10393" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10394" href="../Confluence/#plfa_plfa-part2-Confluence-10394" class="Bound">τ</a><a id="plfa_plfa-part2-Confluence-10395" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10397" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10398" href="../Untyped/#plfa_plfa-part2-Untyped-4282" class="InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-Confluence-10400" href="../Confluence/#plfa_plfa-part2-Confluence-10400" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-10401" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10403" href="../Confluence/#plfa_plfa-part2-Confluence-10403" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-10405" href="../Confluence/#plfa_plfa-part2-Confluence-2651" class="InductiveConstructor">pvar</a> <a id="plfa_plfa-part2-Confluence-10410" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10412" href="../Confluence/#plfa_plfa-part2-Confluence-10403" class="Bound">s</a>
<a id="plfa_plfa-part2-Confluence-10414" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a> <a id="plfa_plfa-part2-Confluence-10424" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10425" href="../Confluence/#plfa_plfa-part2-Confluence-10425" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-10426" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10428" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10429" href="../Confluence/#plfa_plfa-part2-Confluence-10429" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-10430" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10432" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10433" href="../Confluence/#plfa_plfa-part2-Confluence-10433" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-10434" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10436" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10437" href="../Confluence/#plfa_plfa-part2-Confluence-10437" class="Bound">σ</a><a id="plfa_plfa-part2-Confluence-10438" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10440" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10441" href="../Confluence/#plfa_plfa-part2-Confluence-10441" class="Bound">τ</a><a id="plfa_plfa-part2-Confluence-10442" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10444" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10445" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-10447" href="../Confluence/#plfa_plfa-part2-Confluence-10447" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-10448" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10450" href="../Confluence/#plfa_plfa-part2-Confluence-10450" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-10452" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-10453" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-10458" href="../Confluence/#plfa_plfa-part2-Confluence-10458" class="Bound">p</a><a id="plfa_plfa-part2-Confluence-10459" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-10461" class="Symbol">=</a>
  <a id="plfa_plfa-part2-Confluence-10465" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-10470" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-10471" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a> <a id="plfa_plfa-part2-Confluence-10481" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10482" class="Argument">σ</a> <a id="plfa_plfa-part2-Confluence-10484" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10486" href="../Untyped/#plfa_plfa-part2-Untyped-6647" class="Function">exts</a> <a id="plfa_plfa-part2-Confluence-10491" href="../Confluence/#plfa_plfa-part2-Confluence-10437" class="Bound">σ</a><a id="plfa_plfa-part2-Confluence-10492" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10494" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10495" class="Argument">τ</a> <a id="plfa_plfa-part2-Confluence-10497" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10499" href="../Untyped/#plfa_plfa-part2-Untyped-6647" class="Function">exts</a> <a id="plfa_plfa-part2-Confluence-10504" href="../Confluence/#plfa_plfa-part2-Confluence-10441" class="Bound">τ</a><a id="plfa_plfa-part2-Confluence-10505" class="Symbol">}</a>
        <a id="plfa_plfa-part2-Confluence-10515" class="Symbol">(λ</a> <a id="plfa_plfa-part2-Confluence-10518" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10519" href="../Confluence/#plfa_plfa-part2-Confluence-10519" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-10520" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-10522" href="../Confluence/#plfa_plfa-part2-Confluence-10522" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-10523" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10525" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-10527" href="../Confluence/#plfa_plfa-part2-Confluence-9442" class="Function">par-subst-exts</a> <a id="plfa_plfa-part2-Confluence-10542" href="../Confluence/#plfa_plfa-part2-Confluence-10450" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-10544" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10545" class="Argument">x</a> <a id="plfa_plfa-part2-Confluence-10547" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10549" href="../Confluence/#plfa_plfa-part2-Confluence-10522" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-10550" class="Symbol">})</a> <a id="plfa_plfa-part2-Confluence-10553" href="../Confluence/#plfa_plfa-part2-Confluence-10458" class="Bound">p</a><a id="plfa_plfa-part2-Confluence-10554" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-10556" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a> <a id="plfa_plfa-part2-Confluence-10566" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10567" href="../Confluence/#plfa_plfa-part2-Confluence-10567" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-10568" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10570" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10571" href="../Confluence/#plfa_plfa-part2-Confluence-10571" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-10572" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10574" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10575" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-10576" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10578" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10579" href="../Confluence/#plfa_plfa-part2-Confluence-10579" class="Bound">σ</a><a id="plfa_plfa-part2-Confluence-10580" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10582" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10583" href="../Confluence/#plfa_plfa-part2-Confluence-10583" class="Bound">τ</a><a id="plfa_plfa-part2-Confluence-10584" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10586" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10587" href="../Confluence/#plfa_plfa-part2-Confluence-10587" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-10589" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-10591" href="../Confluence/#plfa_plfa-part2-Confluence-10591" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-10592" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10594" href="../Confluence/#plfa_plfa-part2-Confluence-10594" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-10596" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-10597" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-10602" href="../Confluence/#plfa_plfa-part2-Confluence-10602" class="Bound">p₁</a> <a id="plfa_plfa-part2-Confluence-10605" href="../Confluence/#plfa_plfa-part2-Confluence-10605" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-10607" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-10609" class="Symbol">=</a>
  <a id="plfa_plfa-part2-Confluence-10613" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-10618" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-10619" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a> <a id="plfa_plfa-part2-Confluence-10629" href="../Confluence/#plfa_plfa-part2-Confluence-10594" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-10631" href="../Confluence/#plfa_plfa-part2-Confluence-10602" class="Bound">p₁</a><a id="plfa_plfa-part2-Confluence-10633" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-10635" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-10636" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a> <a id="plfa_plfa-part2-Confluence-10646" href="../Confluence/#plfa_plfa-part2-Confluence-10594" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-10648" href="../Confluence/#plfa_plfa-part2-Confluence-10605" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-10650" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-10652" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a> <a id="plfa_plfa-part2-Confluence-10662" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10663" href="../Confluence/#plfa_plfa-part2-Confluence-10663" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-10664" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10666" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10667" href="../Confluence/#plfa_plfa-part2-Confluence-10667" class="Bound">Δ</a><a id="plfa_plfa-part2-Confluence-10668" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10670" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10671" href="../Untyped/#plfa_plfa-part2-Untyped-2820" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-Confluence-10672" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10674" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10675" href="../Confluence/#plfa_plfa-part2-Confluence-10675" class="Bound">σ</a><a id="plfa_plfa-part2-Confluence-10676" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10678" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10679" href="../Confluence/#plfa_plfa-part2-Confluence-10679" class="Bound">τ</a><a id="plfa_plfa-part2-Confluence-10680" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10682" class="Symbol">{(</a><a id="plfa_plfa-part2-Confluence-10684" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-10686" href="../Confluence/#plfa_plfa-part2-Confluence-10686" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-10687" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-10689" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-10691" href="../Confluence/#plfa_plfa-part2-Confluence-10691" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-10692" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10694" href="../Confluence/#plfa_plfa-part2-Confluence-10694" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-10696" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-10697" href="../Confluence/#plfa_plfa-part2-Confluence-2901" class="InductiveConstructor">pbeta</a><a id="plfa_plfa-part2-Confluence-10702" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10703" class="Argument">N′</a> <a id="plfa_plfa-part2-Confluence-10706" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10708" href="../Confluence/#plfa_plfa-part2-Confluence-10708" class="Bound">N′</a><a id="plfa_plfa-part2-Confluence-10710" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-10712" class="Argument">M′</a> <a id="plfa_plfa-part2-Confluence-10715" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10717" href="../Confluence/#plfa_plfa-part2-Confluence-10717" class="Bound">M′</a><a id="plfa_plfa-part2-Confluence-10719" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10721" href="../Confluence/#plfa_plfa-part2-Confluence-10721" class="Bound">p₁</a> <a id="plfa_plfa-part2-Confluence-10724" href="../Confluence/#plfa_plfa-part2-Confluence-10724" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-10726" class="Symbol">)</a>
    <a id="plfa_plfa-part2-Confluence-10732" class="Keyword">with</a> <a id="plfa_plfa-part2-Confluence-10737" href="../Confluence/#plfa_plfa-part2-Confluence-2901" class="InductiveConstructor">pbeta</a> <a id="plfa_plfa-part2-Confluence-10743" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-10744" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a><a id="plfa_plfa-part2-Confluence-10753" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10754" class="Argument">σ</a> <a id="plfa_plfa-part2-Confluence-10756" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10758" href="../Untyped/#plfa_plfa-part2-Untyped-6647" class="Function">exts</a> <a id="plfa_plfa-part2-Confluence-10763" href="../Confluence/#plfa_plfa-part2-Confluence-10675" class="Bound">σ</a><a id="plfa_plfa-part2-Confluence-10764" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-10766" class="Argument">τ</a> <a id="plfa_plfa-part2-Confluence-10768" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10770" href="../Untyped/#plfa_plfa-part2-Untyped-6647" class="Function">exts</a> <a id="plfa_plfa-part2-Confluence-10775" href="../Confluence/#plfa_plfa-part2-Confluence-10679" class="Bound">τ</a><a id="plfa_plfa-part2-Confluence-10776" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-10778" class="Argument">M</a> <a id="plfa_plfa-part2-Confluence-10780" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10782" href="../Confluence/#plfa_plfa-part2-Confluence-10686" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-10783" class="Symbol">}</a>
                        <a id="plfa_plfa-part2-Confluence-10809" class="Symbol">(λ{</a><a id="plfa_plfa-part2-Confluence-10812" href="../Confluence/#plfa_plfa-part2-Confluence-10812" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-10813" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-10815" href="../Confluence/#plfa_plfa-part2-Confluence-10815" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-10816" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10818" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-10820" href="../Confluence/#plfa_plfa-part2-Confluence-9442" class="Function">par-subst-exts</a> <a id="plfa_plfa-part2-Confluence-10835" href="../Confluence/#plfa_plfa-part2-Confluence-10694" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-10837" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10838" class="Argument">x</a> <a id="plfa_plfa-part2-Confluence-10840" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10842" href="../Confluence/#plfa_plfa-part2-Confluence-10815" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-10843" class="Symbol">})</a> <a id="plfa_plfa-part2-Confluence-10846" href="../Confluence/#plfa_plfa-part2-Confluence-10721" class="Bound">p₁</a><a id="plfa_plfa-part2-Confluence-10848" class="Symbol">)</a>
               <a id="plfa_plfa-part2-Confluence-10865" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-10866" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a> <a id="plfa_plfa-part2-Confluence-10876" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10877" class="Argument">σ</a> <a id="plfa_plfa-part2-Confluence-10879" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10881" href="../Confluence/#plfa_plfa-part2-Confluence-10675" class="Bound">σ</a><a id="plfa_plfa-part2-Confluence-10882" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10884" href="../Confluence/#plfa_plfa-part2-Confluence-10694" class="Bound">s</a> <a id="plfa_plfa-part2-Confluence-10886" href="../Confluence/#plfa_plfa-part2-Confluence-10724" class="Bound">p₂</a><a id="plfa_plfa-part2-Confluence-10888" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-10890" class="Symbol">...</a> <a id="plfa_plfa-part2-Confluence-10894" class="Symbol">|</a> <a id="plfa_plfa-part2-Confluence-10896" href="../Confluence/#plfa_plfa-part2-Confluence-10896" class="Bound">G</a> <a id="plfa_plfa-part2-Confluence-10898" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-Confluence-10906" href="../Confluence/#plfa_plfa-part2-Confluence-9953" class="Function">subst-commute</a><a id="plfa_plfa-part2-Confluence-10919" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-10920" class="Argument">N</a> <a id="plfa_plfa-part2-Confluence-10922" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10924" class="Bound">N′</a><a id="plfa_plfa-part2-Confluence-10926" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-10928" class="Argument">M</a> <a id="plfa_plfa-part2-Confluence-10930" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10932" class="Bound">M′</a><a id="plfa_plfa-part2-Confluence-10934" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-10936" class="Argument">σ</a> <a id="plfa_plfa-part2-Confluence-10938" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10940" class="Bound">τ</a><a id="plfa_plfa-part2-Confluence-10941" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-10943" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-10945" href="../Confluence/#plfa_plfa-part2-Confluence-10896" class="Bound">G</a>
</pre><p>We proceed by induction on <code>M ⇛ M′</code>.</p><ul><li><p>Suppose <code>x ⇛ x</code>. We conclude that <code>σ x ⇛ τ x</code> using the premise <code>par-subst σ τ</code>.</p></li><li><p>Suppose <code>ƛ N ⇛ ƛ N′</code> because <code>N ⇛ N′</code>. To use the induction hypothesis, we need <code>par-subst (exts σ) (exts τ)</code>, which we obtain by <code>par-subst-exts</code>. So we have <code>subst (exts σ) N ⇛ subst (exts τ) N′</code> and conclude by rule <code>pabs</code>.</p></li><li><p>Suppose <code>L · M ⇛ L′ · M′</code> because <code>L ⇛ L′</code> and <code>M ⇛ M′</code>. By the induction hypothesis we have <code>subst σ L ⇛ subst τ L′</code> and <code>subst σ M ⇛ subst τ M′</code>, so we conclude by rule <code>papp</code>.</p></li><li><p>Suppose <code>(ƛ N) · M ⇛ N′ [ M′ ]</code> because <code>N ⇛ N′</code> and <code>M ⇛ M′</code>. Again we obtain <code>par-subst (exts σ) (exts τ)</code> by <code>par-subst-exts</code>. So by the induction hypothesis, we have <code>subst (exts σ) N ⇛ subst (exts τ) N′</code> and <code>subst σ M ⇛ subst τ M′</code>. Then by rule <code>pbeta</code>, we have parallel reduction to <code>subst (exts τ) N′ [ subst τ M′ ]</code>. Substitution commutes with itself in the following sense. For any σ, N, and M, we have</p><pre><code>  (subst (exts σ) N) [ subst σ M ] ≡ subst σ (N [ M ])</code></pre><p>So we have parallel reduction to <code>subst τ (N′ [ M′ ])</code>.</p></li></ul><p>Of course, if <code>M ⇛ M′</code>, then <code>subst-zero M</code> pointwise parallel reduces to <code>subst-zero M′</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-par-subst-zero"></a><a id="plfa_plfa-part2-Confluence-12157" href="../Confluence/#plfa_plfa-part2-Confluence-12157" class="Function">par-subst-zero</a> <a id="plfa_plfa-part2-Confluence-12172" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-12174" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-12176" href="../Confluence/#plfa_plfa-part2-Confluence-12176" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-12177" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-12179" href="../Confluence/#plfa_plfa-part2-Confluence-12179" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-12180" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-12182" href="../Confluence/#plfa_plfa-part2-Confluence-12182" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-12184" href="../Confluence/#plfa_plfa-part2-Confluence-12184" class="Bound">M′</a> <a id="plfa_plfa-part2-Confluence-12187" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-12189" href="../Confluence/#plfa_plfa-part2-Confluence-12176" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-12191" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-12193" href="../Confluence/#plfa_plfa-part2-Confluence-12179" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-12194" class="Symbol">}</a>
       <a id="plfa_plfa-part2-Confluence-12203" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-12205" href="../Confluence/#plfa_plfa-part2-Confluence-12182" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-12207" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-12209" href="../Confluence/#plfa_plfa-part2-Confluence-12184" class="Bound">M′</a>
       <a id="plfa_plfa-part2-Confluence-12219" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-12221" href="../Confluence/#plfa_plfa-part2-Confluence-7502" class="Function">par-subst</a> <a id="plfa_plfa-part2-Confluence-12231" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-12232" href="../Untyped/#plfa_plfa-part2-Untyped-7359" class="Function">subst-zero</a> <a id="plfa_plfa-part2-Confluence-12243" href="../Confluence/#plfa_plfa-part2-Confluence-12182" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-12244" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-12246" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-12247" href="../Untyped/#plfa_plfa-part2-Untyped-7359" class="Function">subst-zero</a> <a id="plfa_plfa-part2-Confluence-12258" href="../Confluence/#plfa_plfa-part2-Confluence-12184" class="Bound">M′</a><a id="plfa_plfa-part2-Confluence-12260" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-12262" href="../Confluence/#plfa_plfa-part2-Confluence-12157" class="Function">par-subst-zero</a> <a id="plfa_plfa-part2-Confluence-12277" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-12278" href="../Confluence/#plfa_plfa-part2-Confluence-12278" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-12279" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-12281" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-12282" href="../Confluence/#plfa_plfa-part2-Confluence-12282" class="Bound">M′</a><a id="plfa_plfa-part2-Confluence-12284" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-12286" href="../Confluence/#plfa_plfa-part2-Confluence-12286" class="Bound">p</a> <a id="plfa_plfa-part2-Confluence-12288" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-12289" href="../Confluence/#plfa_plfa-part2-Confluence-12289" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-12290" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-12292" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-12293" href="../Untyped/#plfa_plfa-part2-Untyped-3505" class="InductiveConstructor">Z</a><a id="plfa_plfa-part2-Confluence-12294" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-12296" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-12298" href="../Confluence/#plfa_plfa-part2-Confluence-12286" class="Bound">p</a>
<a id="plfa_plfa-part2-Confluence-12300" href="../Confluence/#plfa_plfa-part2-Confluence-12157" class="Function">par-subst-zero</a> <a id="plfa_plfa-part2-Confluence-12315" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-12316" href="../Confluence/#plfa_plfa-part2-Confluence-12316" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-12317" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-12319" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-12320" href="../Confluence/#plfa_plfa-part2-Confluence-12320" class="Bound">M′</a><a id="plfa_plfa-part2-Confluence-12322" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-12324" href="../Confluence/#plfa_plfa-part2-Confluence-12324" class="Bound">p</a> <a id="plfa_plfa-part2-Confluence-12326" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-12327" href="../Confluence/#plfa_plfa-part2-Confluence-12327" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-12328" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-12330" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-12331" href="../Untyped/#plfa_plfa-part2-Untyped-3550" class="InductiveConstructor Operator">S</a> <a id="plfa_plfa-part2-Confluence-12333" href="../Confluence/#plfa_plfa-part2-Confluence-12333" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-12334" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-12336" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-12338" href="../Confluence/#plfa_plfa-part2-Confluence-2651" class="InductiveConstructor">pvar</a>
</pre><p>We conclude this section with the desired corollary, that substitution respects parallel reduction.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-sub-par"></a><a id="plfa_plfa-part2-Confluence-12457" href="../Confluence/#plfa_plfa-part2-Confluence-12457" class="Function">sub-par</a> <a id="plfa_plfa-part2-Confluence-12465" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-12467" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-12469" href="../Confluence/#plfa_plfa-part2-Confluence-12469" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-12471" href="../Confluence/#plfa_plfa-part2-Confluence-12471" class="Bound">A</a> <a id="plfa_plfa-part2-Confluence-12473" href="../Confluence/#plfa_plfa-part2-Confluence-12473" class="Bound">B</a><a id="plfa_plfa-part2-Confluence-12474" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-12476" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-12477" href="../Confluence/#plfa_plfa-part2-Confluence-12477" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-12479" href="../Confluence/#plfa_plfa-part2-Confluence-12479" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-12482" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-12484" href="../Confluence/#plfa_plfa-part2-Confluence-12469" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-12486" href="../Untyped/#plfa_plfa-part2-Untyped-3131" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-12488" href="../Confluence/#plfa_plfa-part2-Confluence-12471" class="Bound">A</a> <a id="plfa_plfa-part2-Confluence-12490" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-12492" href="../Confluence/#plfa_plfa-part2-Confluence-12473" class="Bound">B</a><a id="plfa_plfa-part2-Confluence-12493" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-12495" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-12496" href="../Confluence/#plfa_plfa-part2-Confluence-12496" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-12498" href="../Confluence/#plfa_plfa-part2-Confluence-12498" class="Bound">M′</a> <a id="plfa_plfa-part2-Confluence-12501" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-12503" href="../Confluence/#plfa_plfa-part2-Confluence-12469" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-12505" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-12507" href="../Confluence/#plfa_plfa-part2-Confluence-12471" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-12508" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-12512" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-12514" href="../Confluence/#plfa_plfa-part2-Confluence-12477" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-12516" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-12518" href="../Confluence/#plfa_plfa-part2-Confluence-12479" class="Bound">N′</a>
  <a id="plfa_plfa-part2-Confluence-12523" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-12525" href="../Confluence/#plfa_plfa-part2-Confluence-12496" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-12527" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-12529" href="../Confluence/#plfa_plfa-part2-Confluence-12498" class="Bound">M′</a>
    <a id="plfa_plfa-part2-Confluence-12536" class="Comment">--------------------------</a>
  <a id="plfa_plfa-part2-Confluence-12565" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-12567" href="../Confluence/#plfa_plfa-part2-Confluence-12477" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-12569" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">[</a> <a id="plfa_plfa-part2-Confluence-12571" href="../Confluence/#plfa_plfa-part2-Confluence-12496" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-12573" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">]</a> <a id="plfa_plfa-part2-Confluence-12575" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-12577" href="../Confluence/#plfa_plfa-part2-Confluence-12479" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-12580" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">[</a> <a id="plfa_plfa-part2-Confluence-12582" href="../Confluence/#plfa_plfa-part2-Confluence-12498" class="Bound">M′</a> <a id="plfa_plfa-part2-Confluence-12585" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">]</a>
<a id="plfa_plfa-part2-Confluence-12587" href="../Confluence/#plfa_plfa-part2-Confluence-12457" class="Function">sub-par</a> <a id="plfa_plfa-part2-Confluence-12595" href="../Confluence/#plfa_plfa-part2-Confluence-12595" class="Bound">pn</a> <a id="plfa_plfa-part2-Confluence-12598" href="../Confluence/#plfa_plfa-part2-Confluence-12598" class="Bound">pm</a> <a id="plfa_plfa-part2-Confluence-12601" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-12603" href="../Confluence/#plfa_plfa-part2-Confluence-10226" class="Function">subst-par</a> <a id="plfa_plfa-part2-Confluence-12613" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-12614" href="../Confluence/#plfa_plfa-part2-Confluence-12157" class="Function">par-subst-zero</a> <a id="plfa_plfa-part2-Confluence-12629" href="../Confluence/#plfa_plfa-part2-Confluence-12598" class="Bound">pm</a><a id="plfa_plfa-part2-Confluence-12631" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-12633" href="../Confluence/#plfa_plfa-part2-Confluence-12595" class="Bound">pn</a>
</pre><h2 id="parallel-reduction-satisfies-the-diamond-property">Parallel reduction satisfies the diamond property</h2><p>The heart of the confluence proof is made of stone, or rather, of diamond! We show that parallel reduction satisfies the diamond property: that if <code>M ⇛ N</code> and <code>M ⇛ N′</code>, then <code>N ⇛ L</code> and <code>N′ ⇛ L</code> for some <code>L</code>. The typical proof is an induction on <code>M ⇛ N</code> and <code>M ⇛ N′</code> so that every possible pair gives rise to a witness <code>L</code> given by performing enough beta reductions in parallel.</p><p>However, a simpler approach is to perform as many beta reductions in parallel as possible on <code>M</code>, say <code>M ⁺</code>, and then show that <code>N</code> also parallel reduces to <code>M ⁺</code>. This is the idea of Takahashi’s <em>complete development</em>. The desired property may be illustrated as</p><pre><code>    M
   /|
  / |
 /  |
N   2
 \  |
  \ |
   \|
    M⁺</code></pre><p>where downward lines are instances of <code>⇛</code>, so we call it the <em>triangle property</em>.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-_⁺"></a><a id="plfa_plfa-part2-Confluence-13524" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">_⁺</a> <a id="plfa_plfa-part2-Confluence-13527" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-13529" class="Symbol">∀</a> <a id="plfa_plfa-part2-Confluence-13531" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-13532" href="../Confluence/#plfa_plfa-part2-Confluence-13532" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-13534" href="../Confluence/#plfa_plfa-part2-Confluence-13534" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-13535" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-13539" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-13541" href="../Confluence/#plfa_plfa-part2-Confluence-13532" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-13543" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-13545" href="../Confluence/#plfa_plfa-part2-Confluence-13534" class="Bound">A</a> <a id="plfa_plfa-part2-Confluence-13547" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-13549" href="../Confluence/#plfa_plfa-part2-Confluence-13532" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-13551" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-13553" href="../Confluence/#plfa_plfa-part2-Confluence-13534" class="Bound">A</a>
<a id="plfa_plfa-part2-Confluence-13555" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13556" href="../Untyped/#plfa_plfa-part2-Untyped-4282" class="InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-Confluence-13558" href="../Confluence/#plfa_plfa-part2-Confluence-13558" class="Bound">x</a><a id="plfa_plfa-part2-Confluence-13559" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-13561" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">⁺</a>       <a id="plfa_plfa-part2-Confluence-13569" class="Symbol">=</a>  <a id="plfa_plfa-part2-Confluence-13572" href="../Untyped/#plfa_plfa-part2-Untyped-4282" class="InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-Confluence-13574" href="../Confluence/#plfa_plfa-part2-Confluence-13558" class="Bound">x</a>
<a id="plfa_plfa-part2-Confluence-13576" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13577" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-13579" href="../Confluence/#plfa_plfa-part2-Confluence-13579" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-13580" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-13582" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">⁺</a>       <a id="plfa_plfa-part2-Confluence-13590" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-13592" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-13594" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13595" href="../Confluence/#plfa_plfa-part2-Confluence-13579" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-13597" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">⁺</a><a id="plfa_plfa-part2-Confluence-13598" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-13600" class="Symbol">((</a><a id="plfa_plfa-part2-Confluence-13602" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-13604" href="../Confluence/#plfa_plfa-part2-Confluence-13604" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-13605" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-13607" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-13609" href="../Confluence/#plfa_plfa-part2-Confluence-13609" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-13610" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-13612" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">⁺</a> <a id="plfa_plfa-part2-Confluence-13614" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-13616" href="../Confluence/#plfa_plfa-part2-Confluence-13604" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-13618" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">⁺</a> <a id="plfa_plfa-part2-Confluence-13620" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">[</a> <a id="plfa_plfa-part2-Confluence-13622" href="../Confluence/#plfa_plfa-part2-Confluence-13609" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-13624" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">⁺</a> <a id="plfa_plfa-part2-Confluence-13626" href="../Untyped/#plfa_plfa-part2-Untyped-7475" class="Function Operator">]</a>
<a id="plfa_plfa-part2-Confluence-13628" class="CatchallClause Symbol">(</a><a id="plfa_plfa-part2-Confluence-13629" href="../Confluence/#plfa_plfa-part2-Confluence-13629" class="CatchallClause Bound">L</a><a id="plfa_plfa-part2-Confluence-13630" class="CatchallClause"> </a><a id="plfa_plfa-part2-Confluence-13631" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="CatchallClause InductiveConstructor Operator">·</a><a id="plfa_plfa-part2-Confluence-13632" class="CatchallClause"> </a><a id="plfa_plfa-part2-Confluence-13633" href="../Confluence/#plfa_plfa-part2-Confluence-13633" class="CatchallClause Bound">M</a><a id="plfa_plfa-part2-Confluence-13634" class="CatchallClause Symbol">)</a><a id="plfa_plfa-part2-Confluence-13635" class="CatchallClause"> </a><a id="plfa_plfa-part2-Confluence-13636" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="CatchallClause Function Operator">⁺</a>     <a id="plfa_plfa-part2-Confluence-13642" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-13644" href="../Confluence/#plfa_plfa-part2-Confluence-13629" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-13646" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">⁺</a> <a id="plfa_plfa-part2-Confluence-13648" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-13650" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13651" href="../Confluence/#plfa_plfa-part2-Confluence-13633" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-13653" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">⁺</a><a id="plfa_plfa-part2-Confluence-13654" class="Symbol">)</a>

<a id="plfa_plfa-part2-Confluence-par-triangle"></a><a id="plfa_plfa-part2-Confluence-13657" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13670" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-13672" class="Symbol">∀</a> <a id="plfa_plfa-part2-Confluence-13674" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-13675" href="../Confluence/#plfa_plfa-part2-Confluence-13675" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-13677" href="../Confluence/#plfa_plfa-part2-Confluence-13677" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-13678" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-13680" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-13681" href="../Confluence/#plfa_plfa-part2-Confluence-13681" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-13683" href="../Confluence/#plfa_plfa-part2-Confluence-13683" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-13685" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-13687" href="../Confluence/#plfa_plfa-part2-Confluence-13675" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-13689" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-13691" href="../Confluence/#plfa_plfa-part2-Confluence-13677" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-13692" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-13696" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-13698" href="../Confluence/#plfa_plfa-part2-Confluence-13681" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-13700" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-13702" href="../Confluence/#plfa_plfa-part2-Confluence-13683" class="Bound">N</a>
    <a id="plfa_plfa-part2-Confluence-13708" class="Comment">-------</a>
  <a id="plfa_plfa-part2-Confluence-13718" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-13720" href="../Confluence/#plfa_plfa-part2-Confluence-13683" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-13722" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-13724" href="../Confluence/#plfa_plfa-part2-Confluence-13681" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-13726" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">⁺</a>
<a id="plfa_plfa-part2-Confluence-13728" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13741" href="../Confluence/#plfa_plfa-part2-Confluence-2651" class="InductiveConstructor">pvar</a>          <a id="plfa_plfa-part2-Confluence-13755" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-13757" href="../Confluence/#plfa_plfa-part2-Confluence-2651" class="InductiveConstructor">pvar</a>
<a id="plfa_plfa-part2-Confluence-13762" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13775" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13776" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-13781" href="../Confluence/#plfa_plfa-part2-Confluence-13781" class="Bound">p</a><a id="plfa_plfa-part2-Confluence-13782" class="Symbol">)</a>      <a id="plfa_plfa-part2-Confluence-13789" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-13791" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-13796" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13797" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13810" href="../Confluence/#plfa_plfa-part2-Confluence-13781" class="Bound">p</a><a id="plfa_plfa-part2-Confluence-13811" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-13813" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13826" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13827" href="../Confluence/#plfa_plfa-part2-Confluence-2901" class="InductiveConstructor">pbeta</a> <a id="plfa_plfa-part2-Confluence-13833" href="../Confluence/#plfa_plfa-part2-Confluence-13833" class="Bound">p1</a> <a id="plfa_plfa-part2-Confluence-13836" href="../Confluence/#plfa_plfa-part2-Confluence-13836" class="Bound">p2</a><a id="plfa_plfa-part2-Confluence-13838" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-13840" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-13842" href="../Confluence/#plfa_plfa-part2-Confluence-12457" class="Function">sub-par</a> <a id="plfa_plfa-part2-Confluence-13850" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13851" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13864" href="../Confluence/#plfa_plfa-part2-Confluence-13833" class="Bound">p1</a><a id="plfa_plfa-part2-Confluence-13866" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-13868" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13869" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13882" href="../Confluence/#plfa_plfa-part2-Confluence-13836" class="Bound">p2</a><a id="plfa_plfa-part2-Confluence-13884" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-13886" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13899" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13900" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-13905" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-13906" class="Argument">L</a> <a id="plfa_plfa-part2-Confluence-13908" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-13910" href="../Untyped/#plfa_plfa-part2-Untyped-4334" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-Confluence-13912" class="Symbol">_</a> <a id="plfa_plfa-part2-Confluence-13914" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-13916" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13917" href="../Confluence/#plfa_plfa-part2-Confluence-2715" class="InductiveConstructor">pabs</a> <a id="plfa_plfa-part2-Confluence-13922" href="../Confluence/#plfa_plfa-part2-Confluence-13922" class="Bound">p1</a><a id="plfa_plfa-part2-Confluence-13924" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-13926" href="../Confluence/#plfa_plfa-part2-Confluence-13926" class="Bound">p2</a><a id="plfa_plfa-part2-Confluence-13928" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-13930" class="Symbol">=</a>
  <a id="plfa_plfa-part2-Confluence-13934" href="../Confluence/#plfa_plfa-part2-Confluence-2901" class="InductiveConstructor">pbeta</a> <a id="plfa_plfa-part2-Confluence-13940" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13941" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13954" href="../Confluence/#plfa_plfa-part2-Confluence-13922" class="Bound">p1</a><a id="plfa_plfa-part2-Confluence-13956" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-13958" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13959" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13972" href="../Confluence/#plfa_plfa-part2-Confluence-13926" class="Bound">p2</a><a id="plfa_plfa-part2-Confluence-13974" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-13976" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-13989" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-13990" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-13995" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-13996" class="Argument">L</a> <a id="plfa_plfa-part2-Confluence-13998" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-14000" href="../Untyped/#plfa_plfa-part2-Untyped-4282" class="InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-Confluence-14002" class="Symbol">_}</a>   <a id="plfa_plfa-part2-Confluence-14007" href="../Confluence/#plfa_plfa-part2-Confluence-14007" class="Bound">p1</a> <a id="plfa_plfa-part2-Confluence-14010" href="../Confluence/#plfa_plfa-part2-Confluence-14010" class="Bound">p2</a><a id="plfa_plfa-part2-Confluence-14012" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-14014" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-14016" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-14021" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-14022" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-14035" href="../Confluence/#plfa_plfa-part2-Confluence-14007" class="Bound">p1</a><a id="plfa_plfa-part2-Confluence-14037" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-14039" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-14040" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-14053" href="../Confluence/#plfa_plfa-part2-Confluence-14010" class="Bound">p2</a><a id="plfa_plfa-part2-Confluence-14055" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-14057" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-14070" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-14071" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-14076" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-14077" class="Argument">L</a> <a id="plfa_plfa-part2-Confluence-14079" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-14081" class="Symbol">_</a> <a id="plfa_plfa-part2-Confluence-14083" href="../Untyped/#plfa_plfa-part2-Untyped-4394" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-Confluence-14085" class="Symbol">_}</a> <a id="plfa_plfa-part2-Confluence-14088" href="../Confluence/#plfa_plfa-part2-Confluence-14088" class="Bound">p1</a> <a id="plfa_plfa-part2-Confluence-14091" href="../Confluence/#plfa_plfa-part2-Confluence-14091" class="Bound">p2</a><a id="plfa_plfa-part2-Confluence-14093" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-14095" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-14097" href="../Confluence/#plfa_plfa-part2-Confluence-2795" class="InductiveConstructor">papp</a> <a id="plfa_plfa-part2-Confluence-14102" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-14103" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-14116" href="../Confluence/#plfa_plfa-part2-Confluence-14088" class="Bound">p1</a><a id="plfa_plfa-part2-Confluence-14118" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-14120" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-14121" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-14134" href="../Confluence/#plfa_plfa-part2-Confluence-14091" class="Bound">p2</a><a id="plfa_plfa-part2-Confluence-14136" class="Symbol">)</a>
</pre><p>The proof of the triangle property is an induction on <code>M ⇛ N</code>.</p><ul><li><p>Suppose <code>x ⇛ x</code>. Clearly <code>x ⁺ = x</code>, so <code>x ⇛ x ⁺</code>.</p></li><li><p>Suppose <code>ƛ M ⇛ ƛ N</code>. By the induction hypothesis we have <code>N ⇛ M ⁺</code> and by definition <code>(λ M) ⁺ = λ (M ⁺)</code>, so we conclude that <code>λ N ⇛ λ (M ⁺)</code>.</p></li><li><p>Suppose <code>(λ N) · M ⇛ N′ [ M′ ]</code>. By the induction hypothesis, we have <code>N′ ⇛ N ⁺</code> and <code>M′ ⇛ M ⁺</code>. Since substitution respects parallel reduction, it follows that <code>N′ [ M′ ] ⇛ N ⁺ [ M ⁺ ]</code>, but the right hand side is exactly <code>((λ N) · M) ⁺</code>, hence <code>N′ [ M′ ] ⇛ ((λ N) · M) ⁺</code>.</p></li><li><p>Suppose <code>(λ L) · M ⇛ (λ L′) · M′</code>. By the induction hypothesis we have <code>L′ ⇛ L ⁺</code> and <code>M′ ⇛ M ⁺</code>; by definition <code>((λ L) · M) ⁺ = L ⁺ [ M ⁺ ]</code>. It follows <code>(λ L′) · M′ ⇛ L ⁺ [ M ⁺ ]</code>.</p></li><li><p>Suppose <code>x · M ⇛ x · M′</code>. By the induction hypothesis we have <code>M′ ⇛ M ⁺</code> and <code>x ⇛ x ⁺</code> so that <code>x · M′ ⇛ x · M ⁺</code>. The remaining case is proved in the same way, so we ignore it. (As there is currently no way in Agda to expand the catch-all pattern in the definition of <code>_⁺</code> for us before checking the right-hand side, we have to write down the remaining case explicitly.)</p></li></ul><p>The diamond property then follows by halving the diamond into two triangles.</p><pre><code>    M
   /|\
  / | \
 /  |  \
N   2   N′
 \  |  /
  \ | /
   \|/
    M⁺</code></pre><p>That is, the diamond property is proved by applying the triangle property on each side with the same confluent term <code>M ⁺</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-par-diamond"></a><a id="plfa_plfa-part2-Confluence-15589" href="../Confluence/#plfa_plfa-part2-Confluence-15589" class="Function">par-diamond</a> <a id="plfa_plfa-part2-Confluence-15601" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-15603" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-15605" href="../Confluence/#plfa_plfa-part2-Confluence-15605" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-15607" href="../Confluence/#plfa_plfa-part2-Confluence-15607" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-15608" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-15610" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-15611" href="../Confluence/#plfa_plfa-part2-Confluence-15611" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-15613" href="../Confluence/#plfa_plfa-part2-Confluence-15613" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-15615" href="../Confluence/#plfa_plfa-part2-Confluence-15615" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-15618" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-15620" href="../Confluence/#plfa_plfa-part2-Confluence-15605" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-15622" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-15624" href="../Confluence/#plfa_plfa-part2-Confluence-15607" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-15625" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-15629" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-15631" href="../Confluence/#plfa_plfa-part2-Confluence-15611" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-15633" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-15635" href="../Confluence/#plfa_plfa-part2-Confluence-15613" class="Bound">N</a>
  <a id="plfa_plfa-part2-Confluence-15639" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-15641" href="../Confluence/#plfa_plfa-part2-Confluence-15611" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-15643" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-15645" href="../Confluence/#plfa_plfa-part2-Confluence-15615" class="Bound">N′</a>
    <a id="plfa_plfa-part2-Confluence-15652" class="Comment">---------------------------------</a>
  <a id="plfa_plfa-part2-Confluence-15688" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-15690" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">Σ[</a> <a id="plfa_plfa-part2-Confluence-15693" href="../Confluence/#plfa_plfa-part2-Confluence-15693" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-15695" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">∈</a> <a id="plfa_plfa-part2-Confluence-15697" href="../Confluence/#plfa_plfa-part2-Confluence-15605" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-15699" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-15701" href="../Confluence/#plfa_plfa-part2-Confluence-15607" class="Bound">A</a> <a id="plfa_plfa-part2-Confluence-15703" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">]</a> <a id="plfa_plfa-part2-Confluence-15705" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-15706" href="../Confluence/#plfa_plfa-part2-Confluence-15613" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-15708" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-15710" href="../Confluence/#plfa_plfa-part2-Confluence-15693" class="Bound">L</a><a id="plfa_plfa-part2-Confluence-15711" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-15713" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1167" class="Function Operator">×</a> <a id="plfa_plfa-part2-Confluence-15715" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-15716" href="../Confluence/#plfa_plfa-part2-Confluence-15615" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-15719" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-15721" href="../Confluence/#plfa_plfa-part2-Confluence-15693" class="Bound">L</a><a id="plfa_plfa-part2-Confluence-15722" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-15724" href="../Confluence/#plfa_plfa-part2-Confluence-15589" class="Function">par-diamond</a> <a id="plfa_plfa-part2-Confluence-15736" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-15737" class="Argument">M</a> <a id="plfa_plfa-part2-Confluence-15739" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-15741" href="../Confluence/#plfa_plfa-part2-Confluence-15741" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-15742" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-15744" href="../Confluence/#plfa_plfa-part2-Confluence-15744" class="Bound">p1</a> <a id="plfa_plfa-part2-Confluence-15747" href="../Confluence/#plfa_plfa-part2-Confluence-15747" class="Bound">p2</a> <a id="plfa_plfa-part2-Confluence-15750" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-15752" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-15754" href="../Confluence/#plfa_plfa-part2-Confluence-15741" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-15756" href="../Confluence/#plfa_plfa-part2-Confluence-13524" class="Function Operator">⁺</a> <a id="plfa_plfa-part2-Confluence-15758" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-15760" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-15762" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-15775" href="../Confluence/#plfa_plfa-part2-Confluence-15744" class="Bound">p1</a> <a id="plfa_plfa-part2-Confluence-15778" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-15780" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-15793" href="../Confluence/#plfa_plfa-part2-Confluence-15747" class="Bound">p2</a> <a id="plfa_plfa-part2-Confluence-15796" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-15798" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a>
</pre><p>This step is optional, though, in the presence of triangle property.</p><h4 id="exercise-practice">Exercise (practice)</h4><ul><li><p>Prove the diamond property <code>par-diamond</code> directly by induction on <code>M ⇛ N</code> and <code>M ⇛ N′</code>.</p></li><li><p>Draw pictures that represent the proofs of each of the six cases in the direct proof of <code>par-diamond</code>. The pictures should consist of nodes and directed edges, where each node is labeled with a term and each edge represents parallel reduction.</p></li></ul><h2 id="proof-of-confluence-for-parallel-reduction">Proof of confluence for parallel reduction</h2><p>As promised at the beginning, the proof that parallel reduction is confluent is easy now that we know it satisfies the triangle property. We just need to prove the strip lemma, which states that if <code>M ⇛ N</code> and <code>M ⇛* N′</code>, then <code>N ⇛* L</code> and <code>N′ ⇛ L</code> for some <code>L</code>. The following diagram illustrates the strip lemma</p><pre><code>    M
   / \
  1   *
 /     \
N       N′
 \     /
  *   1
   \ /
    L</code></pre><p>where downward lines are instances of <code>⇛</code> or <code>⇛*</code>, depending on how they are marked.</p><p>The proof of the strip lemma is a straightforward induction on <code>M ⇛* N′</code>, using the triangle property in the induction step.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-strip"></a><a id="plfa_plfa-part2-Confluence-16933" href="../Confluence/#plfa_plfa-part2-Confluence-16933" class="Function">strip</a> <a id="plfa_plfa-part2-Confluence-16939" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-16941" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-16943" href="../Confluence/#plfa_plfa-part2-Confluence-16943" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-16945" href="../Confluence/#plfa_plfa-part2-Confluence-16945" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-16946" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-16948" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-16949" href="../Confluence/#plfa_plfa-part2-Confluence-16949" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-16951" href="../Confluence/#plfa_plfa-part2-Confluence-16951" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-16953" href="../Confluence/#plfa_plfa-part2-Confluence-16953" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-16956" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-16958" href="../Confluence/#plfa_plfa-part2-Confluence-16943" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-16960" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-16962" href="../Confluence/#plfa_plfa-part2-Confluence-16945" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-16963" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-16967" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-16969" href="../Confluence/#plfa_plfa-part2-Confluence-16949" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-16971" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-16973" href="../Confluence/#plfa_plfa-part2-Confluence-16951" class="Bound">N</a>
  <a id="plfa_plfa-part2-Confluence-16977" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-16979" href="../Confluence/#plfa_plfa-part2-Confluence-16949" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-16981" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-16984" href="../Confluence/#plfa_plfa-part2-Confluence-16953" class="Bound">N′</a>
    <a id="plfa_plfa-part2-Confluence-16991" class="Comment">------------------------------------</a>
  <a id="plfa_plfa-part2-Confluence-17030" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-17032" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">Σ[</a> <a id="plfa_plfa-part2-Confluence-17035" href="../Confluence/#plfa_plfa-part2-Confluence-17035" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-17037" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">∈</a> <a id="plfa_plfa-part2-Confluence-17039" href="../Confluence/#plfa_plfa-part2-Confluence-16943" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-17041" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-17043" href="../Confluence/#plfa_plfa-part2-Confluence-16945" class="Bound">A</a> <a id="plfa_plfa-part2-Confluence-17045" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">]</a> <a id="plfa_plfa-part2-Confluence-17047" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-17048" href="../Confluence/#plfa_plfa-part2-Confluence-16951" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-17050" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-17053" href="../Confluence/#plfa_plfa-part2-Confluence-17035" class="Bound">L</a><a id="plfa_plfa-part2-Confluence-17054" class="Symbol">)</a>  <a id="plfa_plfa-part2-Confluence-17057" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1167" class="Function Operator">×</a>  <a id="plfa_plfa-part2-Confluence-17060" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-17061" href="../Confluence/#plfa_plfa-part2-Confluence-16953" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-17064" href="../Confluence/#plfa_plfa-part2-Confluence-2602" class="Datatype Operator">⇛</a> <a id="plfa_plfa-part2-Confluence-17066" href="../Confluence/#plfa_plfa-part2-Confluence-17035" class="Bound">L</a><a id="plfa_plfa-part2-Confluence-17067" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-17069" href="../Confluence/#plfa_plfa-part2-Confluence-16933" class="Function">strip</a><a id="plfa_plfa-part2-Confluence-17074" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-17075" href="../Confluence/#plfa_plfa-part2-Confluence-17075" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-17076" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17078" href="../Confluence/#plfa_plfa-part2-Confluence-17078" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-17079" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17081" href="../Confluence/#plfa_plfa-part2-Confluence-17081" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-17082" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17084" href="../Confluence/#plfa_plfa-part2-Confluence-17084" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-17085" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17087" href="../Confluence/#plfa_plfa-part2-Confluence-17087" class="Bound">N′</a><a id="plfa_plfa-part2-Confluence-17089" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-17091" href="../Confluence/#plfa_plfa-part2-Confluence-17091" class="Bound">mn</a> <a id="plfa_plfa-part2-Confluence-17094" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-17095" href="../Confluence/#plfa_plfa-part2-Confluence-17081" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-17097" href="../Confluence/#plfa_plfa-part2-Confluence-3763" class="InductiveConstructor Operator">∎</a><a id="plfa_plfa-part2-Confluence-17098" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-17100" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-17102" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17104" href="../Confluence/#plfa_plfa-part2-Confluence-17084" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-17106" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17108" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17110" href="../Confluence/#plfa_plfa-part2-Confluence-17084" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-17112" href="../Confluence/#plfa_plfa-part2-Confluence-3763" class="InductiveConstructor Operator">∎</a> <a id="plfa_plfa-part2-Confluence-17114" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17116" href="../Confluence/#plfa_plfa-part2-Confluence-17091" class="Bound">mn</a> <a id="plfa_plfa-part2-Confluence-17119" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17121" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a>
<a id="plfa_plfa-part2-Confluence-17123" href="../Confluence/#plfa_plfa-part2-Confluence-16933" class="Function">strip</a><a id="plfa_plfa-part2-Confluence-17128" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-17129" href="../Confluence/#plfa_plfa-part2-Confluence-17129" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-17130" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17132" href="../Confluence/#plfa_plfa-part2-Confluence-17132" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-17133" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17135" href="../Confluence/#plfa_plfa-part2-Confluence-17135" class="Bound">M</a><a id="plfa_plfa-part2-Confluence-17136" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17138" href="../Confluence/#plfa_plfa-part2-Confluence-17138" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-17139" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17141" href="../Confluence/#plfa_plfa-part2-Confluence-17141" class="Bound">N′</a><a id="plfa_plfa-part2-Confluence-17143" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-17145" href="../Confluence/#plfa_plfa-part2-Confluence-17145" class="Bound">mn</a> <a id="plfa_plfa-part2-Confluence-17148" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-17149" href="../Confluence/#plfa_plfa-part2-Confluence-17135" class="Bound">M</a> <a id="plfa_plfa-part2-Confluence-17151" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⇛⟨</a> <a id="plfa_plfa-part2-Confluence-17154" href="../Confluence/#plfa_plfa-part2-Confluence-17154" class="Bound">mm&#39;</a> <a id="plfa_plfa-part2-Confluence-17158" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17160" href="../Confluence/#plfa_plfa-part2-Confluence-17160" class="Bound">m&#39;n&#39;</a><a id="plfa_plfa-part2-Confluence-17164" class="Symbol">)</a>
  <a id="plfa_plfa-part2-Confluence-17168" class="Keyword">with</a> <a id="plfa_plfa-part2-Confluence-17173" href="../Confluence/#plfa_plfa-part2-Confluence-16933" class="Function">strip</a> <a id="plfa_plfa-part2-Confluence-17179" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-17180" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-17193" href="../Confluence/#plfa_plfa-part2-Confluence-17154" class="Bound">mm&#39;</a><a id="plfa_plfa-part2-Confluence-17196" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-17198" href="../Confluence/#plfa_plfa-part2-Confluence-17160" class="Bound">m&#39;n&#39;</a>
<a id="plfa_plfa-part2-Confluence-17203" class="Symbol">...</a> <a id="plfa_plfa-part2-Confluence-17207" class="Symbol">|</a> <a id="plfa_plfa-part2-Confluence-17209" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17211" href="../Confluence/#plfa_plfa-part2-Confluence-17211" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-17213" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17215" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17217" href="../Confluence/#plfa_plfa-part2-Confluence-17217" class="Bound">ll&#39;</a> <a id="plfa_plfa-part2-Confluence-17221" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17223" href="../Confluence/#plfa_plfa-part2-Confluence-17223" class="Bound">n&#39;l&#39;</a> <a id="plfa_plfa-part2-Confluence-17228" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17230" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17232" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-17234" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17236" href="../Confluence/#plfa_plfa-part2-Confluence-17211" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-17238" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17240" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17242" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-17244" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⇛⟨</a> <a id="plfa_plfa-part2-Confluence-17247" href="../Confluence/#plfa_plfa-part2-Confluence-13657" class="Function">par-triangle</a> <a id="plfa_plfa-part2-Confluence-17260" class="Bound">mn</a> <a id="plfa_plfa-part2-Confluence-17263" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17265" href="../Confluence/#plfa_plfa-part2-Confluence-17217" class="Bound">ll&#39;</a> <a id="plfa_plfa-part2-Confluence-17269" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17271" href="../Confluence/#plfa_plfa-part2-Confluence-17223" class="Bound">n&#39;l&#39;</a> <a id="plfa_plfa-part2-Confluence-17276" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17278" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a>
</pre><p>The proof of confluence for parallel reduction is now proved by induction on the sequence <code>M ⇛* N</code>, using the above lemma in the induction step.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-par-confluence"></a><a id="plfa_plfa-part2-Confluence-17439" href="../Confluence/#plfa_plfa-part2-Confluence-17439" class="Function">par-confluence</a> <a id="plfa_plfa-part2-Confluence-17454" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-17456" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-17458" href="../Confluence/#plfa_plfa-part2-Confluence-17458" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-17460" href="../Confluence/#plfa_plfa-part2-Confluence-17460" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-17461" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-17463" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-17464" href="../Confluence/#plfa_plfa-part2-Confluence-17464" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-17466" href="../Confluence/#plfa_plfa-part2-Confluence-17466" class="Bound">M₁</a> <a id="plfa_plfa-part2-Confluence-17469" href="../Confluence/#plfa_plfa-part2-Confluence-17469" class="Bound">M₂</a> <a id="plfa_plfa-part2-Confluence-17472" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-17474" href="../Confluence/#plfa_plfa-part2-Confluence-17458" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-17476" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-17478" href="../Confluence/#plfa_plfa-part2-Confluence-17460" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-17479" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-17483" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-17485" href="../Confluence/#plfa_plfa-part2-Confluence-17464" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-17487" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-17490" href="../Confluence/#plfa_plfa-part2-Confluence-17466" class="Bound">M₁</a>
  <a id="plfa_plfa-part2-Confluence-17495" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-17497" href="../Confluence/#plfa_plfa-part2-Confluence-17464" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-17499" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-17502" href="../Confluence/#plfa_plfa-part2-Confluence-17469" class="Bound">M₂</a>
    <a id="plfa_plfa-part2-Confluence-17509" class="Comment">------------------------------------</a>
  <a id="plfa_plfa-part2-Confluence-17548" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-17550" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">Σ[</a> <a id="plfa_plfa-part2-Confluence-17553" href="../Confluence/#plfa_plfa-part2-Confluence-17553" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-17555" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">∈</a> <a id="plfa_plfa-part2-Confluence-17557" href="../Confluence/#plfa_plfa-part2-Confluence-17458" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-17559" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-17561" href="../Confluence/#plfa_plfa-part2-Confluence-17460" class="Bound">A</a> <a id="plfa_plfa-part2-Confluence-17563" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">]</a> <a id="plfa_plfa-part2-Confluence-17565" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-17566" href="../Confluence/#plfa_plfa-part2-Confluence-17466" class="Bound">M₁</a> <a id="plfa_plfa-part2-Confluence-17569" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-17572" href="../Confluence/#plfa_plfa-part2-Confluence-17553" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-17573" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-17575" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1167" class="Function Operator">×</a> <a id="plfa_plfa-part2-Confluence-17577" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-17578" href="../Confluence/#plfa_plfa-part2-Confluence-17469" class="Bound">M₂</a> <a id="plfa_plfa-part2-Confluence-17581" href="../Confluence/#plfa_plfa-part2-Confluence-3713" class="Datatype Operator">⇛*</a> <a id="plfa_plfa-part2-Confluence-17584" href="../Confluence/#plfa_plfa-part2-Confluence-17553" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-17585" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-17587" href="../Confluence/#plfa_plfa-part2-Confluence-17439" class="Function">par-confluence</a> <a id="plfa_plfa-part2-Confluence-17602" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-17603" href="../Confluence/#plfa_plfa-part2-Confluence-17603" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-17604" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17606" href="../Confluence/#plfa_plfa-part2-Confluence-17606" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-17607" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17609" href="../Confluence/#plfa_plfa-part2-Confluence-17609" class="Bound">L</a><a id="plfa_plfa-part2-Confluence-17610" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17612" class="DottedPattern Symbol">.</a><a id="plfa_plfa-part2-Confluence-17613" href="../Confluence/#plfa_plfa-part2-Confluence-17609" class="DottedPattern Bound">L</a><a id="plfa_plfa-part2-Confluence-17614" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17616" href="../Confluence/#plfa_plfa-part2-Confluence-17616" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-17617" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-17619" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-17620" href="../Confluence/#plfa_plfa-part2-Confluence-17609" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-17622" href="../Confluence/#plfa_plfa-part2-Confluence-3763" class="InductiveConstructor Operator">∎</a><a id="plfa_plfa-part2-Confluence-17623" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-17625" href="../Confluence/#plfa_plfa-part2-Confluence-17625" class="Bound">L⇛*N</a> <a id="plfa_plfa-part2-Confluence-17630" class="Symbol">=</a> <a id="plfa_plfa-part2-Confluence-17632" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17634" href="../Confluence/#plfa_plfa-part2-Confluence-17616" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-17636" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17638" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17640" href="../Confluence/#plfa_plfa-part2-Confluence-17625" class="Bound">L⇛*N</a> <a id="plfa_plfa-part2-Confluence-17645" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17647" href="../Confluence/#plfa_plfa-part2-Confluence-17616" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-17649" href="../Confluence/#plfa_plfa-part2-Confluence-3763" class="InductiveConstructor Operator">∎</a> <a id="plfa_plfa-part2-Confluence-17651" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17653" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a>
<a id="plfa_plfa-part2-Confluence-17655" href="../Confluence/#plfa_plfa-part2-Confluence-17439" class="Function">par-confluence</a> <a id="plfa_plfa-part2-Confluence-17670" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-17671" href="../Confluence/#plfa_plfa-part2-Confluence-17671" class="Bound">Γ</a><a id="plfa_plfa-part2-Confluence-17672" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17674" href="../Confluence/#plfa_plfa-part2-Confluence-17674" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-17675" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17677" href="../Confluence/#plfa_plfa-part2-Confluence-17677" class="Bound">L</a><a id="plfa_plfa-part2-Confluence-17678" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17680" href="../Confluence/#plfa_plfa-part2-Confluence-17680" class="Bound">M₁′</a><a id="plfa_plfa-part2-Confluence-17683" class="Symbol">}{</a><a id="plfa_plfa-part2-Confluence-17685" href="../Confluence/#plfa_plfa-part2-Confluence-17685" class="Bound">M₂</a><a id="plfa_plfa-part2-Confluence-17687" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-17689" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-17690" href="../Confluence/#plfa_plfa-part2-Confluence-17677" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-17692" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⇛⟨</a> <a id="plfa_plfa-part2-Confluence-17695" href="../Confluence/#plfa_plfa-part2-Confluence-17695" class="Bound">L⇛M₁</a> <a id="plfa_plfa-part2-Confluence-17700" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17702" href="../Confluence/#plfa_plfa-part2-Confluence-17702" class="Bound">M₁⇛*M₁′</a><a id="plfa_plfa-part2-Confluence-17709" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-17711" href="../Confluence/#plfa_plfa-part2-Confluence-17711" class="Bound">L⇛*M₂</a>
    <a id="plfa_plfa-part2-Confluence-17721" class="Keyword">with</a> <a id="plfa_plfa-part2-Confluence-17726" href="../Confluence/#plfa_plfa-part2-Confluence-16933" class="Function">strip</a> <a id="plfa_plfa-part2-Confluence-17732" href="../Confluence/#plfa_plfa-part2-Confluence-17695" class="Bound">L⇛M₁</a> <a id="plfa_plfa-part2-Confluence-17737" href="../Confluence/#plfa_plfa-part2-Confluence-17711" class="Bound">L⇛*M₂</a>
<a id="plfa_plfa-part2-Confluence-17743" class="Symbol">...</a> <a id="plfa_plfa-part2-Confluence-17747" class="Symbol">|</a> <a id="plfa_plfa-part2-Confluence-17749" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17751" href="../Confluence/#plfa_plfa-part2-Confluence-17751" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-17753" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17755" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17757" href="../Confluence/#plfa_plfa-part2-Confluence-17757" class="Bound">M₁⇛*N</a> <a id="plfa_plfa-part2-Confluence-17763" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17765" href="../Confluence/#plfa_plfa-part2-Confluence-17765" class="Bound">M₂⇛N</a> <a id="plfa_plfa-part2-Confluence-17770" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17772" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a>
      <a id="plfa_plfa-part2-Confluence-17780" class="Keyword">with</a> <a id="plfa_plfa-part2-Confluence-17785" href="../Confluence/#plfa_plfa-part2-Confluence-17439" class="Function">par-confluence</a> <a id="plfa_plfa-part2-Confluence-17800" class="Bound">M₁⇛*M₁′</a> <a id="plfa_plfa-part2-Confluence-17808" href="../Confluence/#plfa_plfa-part2-Confluence-17757" class="Bound">M₁⇛*N</a>
<a id="plfa_plfa-part2-Confluence-17814" class="Symbol">...</a>   <a id="plfa_plfa-part2-Confluence-17820" class="Symbol">|</a> <a id="plfa_plfa-part2-Confluence-17822" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17824" href="../Confluence/#plfa_plfa-part2-Confluence-17824" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-17827" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17829" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17831" href="../Confluence/#plfa_plfa-part2-Confluence-17831" class="Bound">M₁′⇛*N′</a> <a id="plfa_plfa-part2-Confluence-17839" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17841" href="../Confluence/#plfa_plfa-part2-Confluence-17841" class="Bound">N⇛*N′</a> <a id="plfa_plfa-part2-Confluence-17847" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17849" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17851" class="Symbol">=</a>
        <a id="plfa_plfa-part2-Confluence-17861" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17863" href="../Confluence/#plfa_plfa-part2-Confluence-17824" class="Bound">N′</a> <a id="plfa_plfa-part2-Confluence-17866" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17868" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-17870" href="../Confluence/#plfa_plfa-part2-Confluence-17831" class="Bound">M₁′⇛*N′</a> <a id="plfa_plfa-part2-Confluence-17878" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-17880" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-17881" class="Bound">M₂</a> <a id="plfa_plfa-part2-Confluence-17884" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⇛⟨</a> <a id="plfa_plfa-part2-Confluence-17887" class="Bound">M₂⇛N</a> <a id="plfa_plfa-part2-Confluence-17892" href="../Confluence/#plfa_plfa-part2-Confluence-3819" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17894" href="../Confluence/#plfa_plfa-part2-Confluence-17841" class="Bound">N⇛*N′</a><a id="plfa_plfa-part2-Confluence-17899" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-17901" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-17903" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a>
</pre><p>The step case may be illustrated as follows:</p><pre><code>        L
       / \
      1   *
     /     \
    M₁ (a)  M₂
   / \     /
  *   *   1
 /     \ /
M₁′(b)  N
 \     /
  *   *
   \ /
    N′</code></pre><p>where downward lines are instances of <code>⇛</code> or <code>⇛*</code>, depending on how they are marked. Here <code>(a)</code> holds by <code>strip</code> and <code>(b)</code> holds by induction.</p><h2 id="proof-of-confluence-for-reduction">Proof of confluence for reduction</h2><p>Confluence of reduction is a corollary of confluence for parallel reduction. From <code>L —↠ M₁</code> and <code>L —↠ M₂</code> we have <code>L ⇛* M₁</code> and <code>L ⇛* M₂</code> by <code>betas-pars</code>. Then by confluence we obtain some <code>L</code> such that <code>M₁ ⇛* N</code> and <code>M₂ ⇛* N</code>, from which we conclude that <code>M₁ —↠ N</code> and <code>M₂ —↠ N</code> by <code>pars-betas</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-Confluence-confluence"></a><a id="plfa_plfa-part2-Confluence-18636" href="../Confluence/#plfa_plfa-part2-Confluence-18636" class="Function">confluence</a> <a id="plfa_plfa-part2-Confluence-18647" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-18649" class="Symbol">∀{</a><a id="plfa_plfa-part2-Confluence-18651" href="../Confluence/#plfa_plfa-part2-Confluence-18651" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-18653" href="../Confluence/#plfa_plfa-part2-Confluence-18653" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-18654" class="Symbol">}</a> <a id="plfa_plfa-part2-Confluence-18656" class="Symbol">{</a><a id="plfa_plfa-part2-Confluence-18657" href="../Confluence/#plfa_plfa-part2-Confluence-18657" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-18659" href="../Confluence/#plfa_plfa-part2-Confluence-18659" class="Bound">M₁</a> <a id="plfa_plfa-part2-Confluence-18662" href="../Confluence/#plfa_plfa-part2-Confluence-18662" class="Bound">M₂</a> <a id="plfa_plfa-part2-Confluence-18665" class="Symbol">:</a> <a id="plfa_plfa-part2-Confluence-18667" href="../Confluence/#plfa_plfa-part2-Confluence-18651" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-18669" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-18671" href="../Confluence/#plfa_plfa-part2-Confluence-18653" class="Bound">A</a><a id="plfa_plfa-part2-Confluence-18672" class="Symbol">}</a>
  <a id="plfa_plfa-part2-Confluence-18676" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-18678" href="../Confluence/#plfa_plfa-part2-Confluence-18657" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-18680" href="../Untyped/#plfa_plfa-part2-Untyped-11088" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-Confluence-18683" href="../Confluence/#plfa_plfa-part2-Confluence-18659" class="Bound">M₁</a>
  <a id="plfa_plfa-part2-Confluence-18688" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-18690" href="../Confluence/#plfa_plfa-part2-Confluence-18657" class="Bound">L</a> <a id="plfa_plfa-part2-Confluence-18692" href="../Untyped/#plfa_plfa-part2-Untyped-11088" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-Confluence-18695" href="../Confluence/#plfa_plfa-part2-Confluence-18662" class="Bound">M₂</a>
    <a id="plfa_plfa-part2-Confluence-18702" class="Comment">-----------------------------------</a>
  <a id="plfa_plfa-part2-Confluence-18740" class="Symbol">→</a> <a id="plfa_plfa-part2-Confluence-18742" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">Σ[</a> <a id="plfa_plfa-part2-Confluence-18745" href="../Confluence/#plfa_plfa-part2-Confluence-18745" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-18747" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">∈</a> <a id="plfa_plfa-part2-Confluence-18749" href="../Confluence/#plfa_plfa-part2-Confluence-18651" class="Bound">Γ</a> <a id="plfa_plfa-part2-Confluence-18751" href="../Untyped/#plfa_plfa-part2-Untyped-4246" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-Confluence-18753" href="../Confluence/#plfa_plfa-part2-Confluence-18653" class="Bound">A</a> <a id="plfa_plfa-part2-Confluence-18755" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#916" class="Function">]</a> <a id="plfa_plfa-part2-Confluence-18757" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-18758" href="../Confluence/#plfa_plfa-part2-Confluence-18659" class="Bound">M₁</a> <a id="plfa_plfa-part2-Confluence-18761" href="../Untyped/#plfa_plfa-part2-Untyped-11088" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-Confluence-18764" href="../Confluence/#plfa_plfa-part2-Confluence-18745" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-18765" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-18767" href="https://agda.github.io/agda-stdlib/v1.7.1/Data.Product.html#1167" class="Function Operator">×</a> <a id="plfa_plfa-part2-Confluence-18769" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-18770" href="../Confluence/#plfa_plfa-part2-Confluence-18662" class="Bound">M₂</a> <a id="plfa_plfa-part2-Confluence-18773" href="../Untyped/#plfa_plfa-part2-Untyped-11088" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-Confluence-18776" href="../Confluence/#plfa_plfa-part2-Confluence-18745" class="Bound">N</a><a id="plfa_plfa-part2-Confluence-18777" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-18779" href="../Confluence/#plfa_plfa-part2-Confluence-18636" class="Function">confluence</a> <a id="plfa_plfa-part2-Confluence-18790" href="../Confluence/#plfa_plfa-part2-Confluence-18790" class="Bound">L↠M₁</a> <a id="plfa_plfa-part2-Confluence-18795" href="../Confluence/#plfa_plfa-part2-Confluence-18795" class="Bound">L↠M₂</a>
    <a id="plfa_plfa-part2-Confluence-18804" class="Keyword">with</a> <a id="plfa_plfa-part2-Confluence-18809" href="../Confluence/#plfa_plfa-part2-Confluence-17439" class="Function">par-confluence</a> <a id="plfa_plfa-part2-Confluence-18824" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-18825" href="../Confluence/#plfa_plfa-part2-Confluence-4927" class="Function">betas-pars</a> <a id="plfa_plfa-part2-Confluence-18836" href="../Confluence/#plfa_plfa-part2-Confluence-18790" class="Bound">L↠M₁</a><a id="plfa_plfa-part2-Confluence-18840" class="Symbol">)</a> <a id="plfa_plfa-part2-Confluence-18842" class="Symbol">(</a><a id="plfa_plfa-part2-Confluence-18843" href="../Confluence/#plfa_plfa-part2-Confluence-4927" class="Function">betas-pars</a> <a id="plfa_plfa-part2-Confluence-18854" href="../Confluence/#plfa_plfa-part2-Confluence-18795" class="Bound">L↠M₂</a><a id="plfa_plfa-part2-Confluence-18858" class="Symbol">)</a>
<a id="plfa_plfa-part2-Confluence-18860" class="Symbol">...</a> <a id="plfa_plfa-part2-Confluence-18864" class="Symbol">|</a> <a id="plfa_plfa-part2-Confluence-18866" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-18868" href="../Confluence/#plfa_plfa-part2-Confluence-18868" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-18870" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-18872" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-18874" href="../Confluence/#plfa_plfa-part2-Confluence-18874" class="Bound">M₁⇛N</a> <a id="plfa_plfa-part2-Confluence-18879" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-18881" href="../Confluence/#plfa_plfa-part2-Confluence-18881" class="Bound">M₂⇛N</a> <a id="plfa_plfa-part2-Confluence-18886" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-18888" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-18890" class="Symbol">=</a>
      <a id="plfa_plfa-part2-Confluence-18898" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-18900" href="../Confluence/#plfa_plfa-part2-Confluence-18868" class="Bound">N</a> <a id="plfa_plfa-part2-Confluence-18902" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-18904" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-Confluence-18906" href="../Confluence/#plfa_plfa-part2-Confluence-6833" class="Function">pars-betas</a> <a id="plfa_plfa-part2-Confluence-18917" href="../Confluence/#plfa_plfa-part2-Confluence-18874" class="Bound">M₁⇛N</a> <a id="plfa_plfa-part2-Confluence-18922" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-Confluence-18924" href="../Confluence/#plfa_plfa-part2-Confluence-6833" class="Function">pars-betas</a> <a id="plfa_plfa-part2-Confluence-18935" href="../Confluence/#plfa_plfa-part2-Confluence-18881" class="Bound">M₂⇛N</a> <a id="plfa_plfa-part2-Confluence-18940" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-Confluence-18942" href="../Confluence/#plfa_plfa-part2-Confluence-2197" class="InductiveConstructor Operator">⟩</a>
</pre><h2 id="notes">Notes</h2><p>Broadly speaking, this proof of confluence, based on parallel reduction, is due to W. Tait and P. Martin-Löf (see Barendregt 1984, Section 3.2). Details of the mechanization come from several sources. The <code>subst-par</code> lemma is the “strong substitutivity” lemma of Shafer, Tebbi, and Smolka (ITP 2015). The proofs of <code>par-triangle</code>, <code>strip</code>, and <code>par-confluence</code> are based on the notion of complete development by Takahashi (1995) and Pfenning’s 1992 technical report about the Church-Rosser theorem. In addition, we consulted Nipkow and Berghofer’s mechanization in Isabelle, which is based on an earlier article by Nipkow (JAR 1996).</p><h2 id="unicode">Unicode</h2><p>This chapter uses the following unicode:</p><pre><code>⇛  U+21DB  RIGHTWARDS TRIPLE ARROW (\r== or \Rrightarrow)
⁺  U+207A  SUPERSCRIPT PLUS SIGN   (\^+)</code></pre></div><nav class="pager"><ul class="pagination"><li><a class="pagelink" href="../Untyped/">Prev</a></li><li class="separator">•</li><li><a class="pagelink" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/part2/Confluence.lagda.md">Source</a></li><li class="separator">•</li><li><a class="pagelink" href="../BigStep/">Next</a></li><li class="separator">•</li></ul></nav></article></div></main><footer class="site-footer h-card"><data class="u-url" href="../"></data><div class="wrapper"><h2 class="footer-heading">Programming Language Foundations in Agda</h2><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Philip Wadler</li><li><a class="u-email" href="mailto:wadler@inf.ed.ac.uk"><i class="far fa-envelope"></i>  wadler@inf.ed.ac.uk</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a rel="me" href="https://github.com/wadler" title="wadler"><i class="fab fa-github"></i>  wadler</a></li></ul></div><div class="footer-col footer-col-3"></div></div><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Wen Kokke</li><li><a class="u-email" href="mailto:me@wen.works"><i class="far fa-envelope"></i>  me@wen.works</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a rel="me" href="https://github.com/wenkokke" title="wenkokke"><i class="fab fa-github"></i>  wenkokke</a></li><li><a rel="me" href="https://twitter.com/wenkokke" title="wenkokke"><i class="fab fa-twitter"></i>  wenkokke</a></li></ul></div><div class="footer-col footer-col-3"></div></div><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Jeremy G. Siek</li><li><a class="u-email" href="mailto:jsiek@indiana.edu"><i class="far fa-envelope"></i>  jsiek@indiana.edu</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a rel="me" href="https://github.com/jsiek" title="jsiek"><i class="fab fa-github"></i>  jsiek</a></li><li><a rel="me" href="https://twitter.com/jeremysiek" title="jeremysiek"><i class="fab fa-twitter"></i>  jeremysiek</a></li></ul></div><div class="footer-col footer-col-3"></div></div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a></div></footer></body></html>